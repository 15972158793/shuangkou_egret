var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),BaseUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onEnable,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemove,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){},t.prototype.onRemove=function(){},t.prototype.setCenter=function(){this.horizontalCenter=0,this.verticalCenter=0},t.prototype.setBottom=function(){this.x=(App.StageUtils.stageWidth-this.width)/2,this.y=App.StageUtils.stageHeight-this.height},t.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},t.prototype.onDestroy=function(){},t}(eui.Component);__reflect(BaseUI.prototype,"BaseUI");var SingleClass=function(){function e(){}return e.getInstance=function(){var e=this;return null==e.instance&&(e.instance=new e),e.instance},e}();__reflect(SingleClass.prototype,"SingleClass");var BaseApp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moduleList={},t}return __extends(t,e),t.prototype.registerController=function(e,t){this.moduleList[e]=t,t.onRegister()},t.prototype.unRegisterController=function(e){this.moduleList[e].onRemove(),delete this.moduleList[e]},t.prototype.getController=function(e){return this.moduleList[e]},t.prototype.sendEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];(o=App.EventManager).sendEvent.apply(o,[e].concat(t));var o},t.prototype.addEvent=function(e,t,n){App.EventManager.addEvent(e,t,n)},t.prototype.removeEvent=function(e,t,n){App.EventManager.removeEvent(e,t,n)},t}(SingleClass);__reflect(BaseApp.prototype,"BaseApp");var BaseController=function(){function e(){}return e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e.prototype.sendEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];App.EventManager.sendEvent(e,t)},e.prototype.addEvent=function(e,t,n){App.EventManager.addEvent(e,t,n)},e.prototype.removeEvent=function(e,t,n){App.EventManager.removeEvent(e,t,n)},e}();__reflect(BaseController.prototype,"BaseController");var BasePanel=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter()},t.prototype.onRemove=function(){},t.prototype.show=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),App.PopUpManager.addPopUp(this,e,t)},t.prototype.hide=function(){App.PopUpManager.removePopUp(this)},t}(BaseUI);__reflect(BasePanel.prototype,"BasePanel");var BaseScene=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.setController=function(e){this.ctrl=e},t}(BaseUI);__reflect(BaseScene.prototype,"BaseScene");var WxInfo=function(){function e(){this.yetDeskCode=!0}return e}();__reflect(WxInfo.prototype,"WxInfo");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function o(o){t.call(n,o,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?o(r):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,o){function r(e){t.call(o,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(o))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var BitmapMovie=function(e){function t(){var t=e.call(this)||this;return t.bmdList=[],t.curFrame=0,t.totalFrame=0,t.delay=33,t.loop=1,t}return __extends(t,e),t.prototype.setImgBuffer=function(e,t,n){for(var o=n-t,r=0;o>=r;r++)this.bmdList.push(RES.getRes(e+r+"_png"));this.curFrame=0,this.bitmapData=this.bmdList[0],this.totalFrame=this.bmdList.length},t.prototype.play=function(e){void 0===e&&(e=1),this.loop=e,this.startTimer()},t.prototype.gotoAndPlay=function(e,t){void 0===t&&(t=1),this.curFrame=e,this.bitmapData=this.bmdList[this.curFrame],this.play(t)},t.prototype.stop=function(){this.stopTimer()},t.prototype.startTimer=function(){this.animTimer||(this.animTimer=new egret.Timer(this.delay)),this.animTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.animTimer.delay=this.delay,this.animTimer.reset(),this.animTimer.start()},t.prototype.onTimer=function(){if(this.curFrame==this.totalFrame){if(this.loop--,!(this.loop>0))return this.stopTimer(),void this.dispatchEvent(new egret.Event(egret.Event.COMPLETE));this.gotoAndPlay(0,this.loop)}this.bitmapData=this.bmdList[this.curFrame],this.curFrame++},t.prototype.stopTimer=function(){this.animTimer&&(this.animTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.animTimer.stop())},t}(egret.Bitmap);__reflect(BitmapMovie.prototype,"BitmapMovie");var GameSound=function(){function e(){}return e.getSoundName=function(e,t,n){var o="man";return 1==e?o="man":2==e&&(o="woman"),1==t?o+="_oneCard"+n+"_mp3":2==t?o+="_DB_"+n+"_mp3":3==t?o+="_THREE_"+n+"_mp3":4==t?o+="_shunzi_mp3":5==t?o+="_liandui_mp3":6==t?o+="_plane_mp3":t>=7&&26>=t&&(o+="_boom_mp3"),o},e.getChatSoundName=function(e,t){var n=["大家好，很高兴见到大家。","快点吧，我等得花都谢了！","不要走，决战到天亮。","你是帅哥还是美女啊。","君子报仇，十盘不算晚。","打错了，呜呜呜呜。"],o="";return 1==e?o="man":2==e&&(o="woman"),t==n[0]?o+="_chat0_mp3":t==n[1]?o+="_chat1_mp3":t==n[2]?o+="_chat2_mp3":t==n[3]?o+="_chat3_mp3":t==n[4]?o+="_chat4_mp3":t==n[5]?o+="_chat5_mp3":t==n[6]?o+="_chat6_mp3":t==n[7]?o+="_chat7_mp3":t==n[8]&&(o+="_chat8_mp3"),o},e}();__reflect(GameSound.prototype,"GameSound");var ClientSocket=function(){function e(){this.name="",this.callBackList={},this.objList={},this.reconnecting=!1,this.reconInvalTime=3e3,this.curReconnectCount=0,this.reconnenctLimit=5,this.bAllowReconnnect=!1,this.protoBuffer="",this.dataBuffer=null,this.url="",this.recieveCount=0}return e.prototype.register=function(e,t,n){this.callBackList[e]=t,this.objList[e]=n},e.prototype.unRegister=function(e){delete this.callBackList[e],delete this.objList[e]},e.prototype.startConnect=function(e,t){void 0===t&&(t=!1),console.log("开始连接"+this.name+":"+e),this.url=e,this.bAllowReconnnect=t,this.createSocket(),this.socket.connectByUrl(e)},e.prototype.newSock=function(e,t){},e.prototype.createSocket=function(){this.socket&&(this.socket.removeEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.socket.connected&&this.socket.close()),this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_STRING,this.socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this)},e.prototype.onConnect=function(e){egret.log(this.name+" connect success"),egret.log(this.name+"连接成功"),this.resetReconnenct(),App.EventManager.sendEvent(EventConst.SocketConnect,this);var t=this;this.checkInt=setInterval(function(){t.checkSock()},3e3)},e.prototype.checkSock=function(){if(!this.isConnected()){clearInterval(this.checkInt);var e=App.MsgBoxManager.getBoxB();e.showMsg("网络连接失败，请检查你的网络设置"),e.ok=function(){egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"restart"}))}}},e.prototype.onClose=function(e){if(egret.log(this.name+" close"),(0==this.bAllowReconnnect||this.bAllowReconnnect&&this.curReconnectCount>this.reconnenctLimit)&&(this.resetReconnenct(),App.EventManager.sendEvent(EventConst.SocketClose,this)),"iOS"==egret.Capabilities.os){clearInterval(this.checkInt);var t=App.MsgBoxManager.getBoxB();t.showMsg("网络连接失败，请检查你的网络设置"),t.ok=function(){egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"restart"}))}}},e.prototype.onError=function(e){if(egret.log(this.name+" error"),"iOS"==egret.Capabilities.os){clearInterval(this.checkInt);var t=App.MsgBoxManager.getBoxB();t.showMsg("网络连接失败，请检查你的网络设置"),t.ok=function(){egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"restart"}))}}else 0==this.tryReconnect()&&App.EventManager.sendEvent(EventConst.SocketIOError,this)},e.prototype.tryReconnect=function(){return 0==this.bAllowReconnnect?!1:(this.curReconnectCount++,this.curReconnectCount<=this.reconnenctLimit?(1==this.curReconnectCount&&App.EventManager.sendEvent(EventConst.StartReconnect,this),egret.setTimeout(this.startConnect,this,this.reconInvalTime,this.url,!0),!0):!1)},e.prototype.close=function(){this.socket&&(this.socket.removeEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.socket.connected&&this.socket.close()),this.resetReconnenct(),this.dataBuffer=null,this.protoBuffer=null},e.prototype.resetReconnenct=function(){this.reconnecting=!1,this.curReconnectCount=0},e.prototype.isConnected=function(){return this.socket&&this.socket.connected?!0:!1},e.prototype.send=function(e){void 0===e&&(e={}),console.log(e),window.parent.postMessage(JSON.stringify(e),"*")},e.prototype.process=function(e){if(console.log("待解析数据:",e),e.forLobby)switch(e.cmd){case"ready":var t=egret.getOption("roomId"),n=egret.getOption("roleId"),o={cmd:131002,roleId:n,roomId:t};App.gameSocket.send(o);break;case"uploadVoiceSuccess":var r={cmd:131009,serverId:e.serverId,roleId:egret.getOption("roleId")};this.send(r);break;case"offline":var a=App.MsgBoxManager.getBoxAD();a.showMsg("您的网络已断开，点击确定重新登录"),a.ok=function(){window.parent.postMessage({forLobby:!0,cmd:"refresh"},"*")}}else{if(!e.hasOwnProperty("cmd"))return void console.log("未知指令");var i=e.cmd,s=this.callBackList[i],p=this.objList[i];s&&p?s.call(p,e):console.log("不存在对应消息:",i)}},e.prototype.reConnectStart=function(){this.send("{cmd:100}"),this.recieveCount++,this.recieveCount>=2},e.prototype.enterScoketTo13Dao=function(){return this.socket?this.socket:void 0},e.prototype.exitScoketFrom13Dao=function(){this.socket},e}();__reflect(ClientSocket.prototype,"ClientSocket");var CryptoUtils=function(){function e(){this.key="YUS!8W@zyl@k9NrQ"}return Object.defineProperty(e,"instance",{get:function(){return this._instance?this._instance:(this._instance=new e,this._instance)},enumerable:!0,configurable:!0}),e.prototype.encrypt=function(e){var t=JSON.stringify(e),t=rc4(t,this.key);return t=base64_encode(t),t=t.replace(/\+/g,"-")},e.prototype.decrypt=function(e){var t=base64_decode(e);t=rc4(t,this.key);var n=JSON.parse(t);return n},e}();__reflect(CryptoUtils.prototype,"CryptoUtils");var HttpSender=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.send=function(e,t,n){var o=(JSON.stringify(e),App.DataCenter.ServerInfo.WEB_URL);console.log("send url:"+o);var r=new egret.HttpRequest;r.open(o,egret.HttpMethod.GET),r.once(egret.Event.COMPLETE,function(e){var o=e.currentTarget;console.log("requet.response:"+o.response);var r=JSON.parse(o.response);t.call(n,r)},this),r.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("error : event="+e)},this),r.send()},t.prototype.sendByUrl=function(e,t,n){var o=new egret.HttpRequest;o.open(e,egret.HttpMethod.GET),o.once(egret.Event.COMPLETE,function(e){var o=e.currentTarget;console.error("requet.response: "+decodeURIComponent(o.response)),t.call(n,decodeURIComponent(o.response))},this),o.once(egret.IOErrorEvent.IO_ERROR,function(e){console.error("error : event="+e)},this),o.send()},t}(SingleClass);__reflect(HttpSender.prototype,"HttpSender");var SocketManager=function(e){function t(){var t=e.call(this)||this;return t.gameSocket=new ClientSocket,t.gameSocket.name="gameSocket",t.pushSocket=new ClientSocket,t.pushSocket.name="pushSocket",t.serverSocket=new ClientSocket,t.serverSocket.name="serverSocket",t}return __extends(t,e),t}(SingleClass);__reflect(SocketManager.prototype,"SocketManager");var ArrayTool=function(){function e(){}return e.copyArr=function(e){for(var t=[],n=e.length,o=0;n>o;o++)t[o]=e[o];return t},e.sortArr=function(e){for(var t=e.length,n=0;t>n;n++)for(var o=n+1;t>o;o++)if(e[n]>e[o]){var r=e[n];e[n]=e[o],e[o]=r}},e.sortScrollGroup=function(e,t,n,o,r,a){for(var i,s,p,c=e.numChildren,l=0;c>l;l++)p=e.getChildAt(l),i=Math.floor(l/t),s=l%t,p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,p.x=(s+1)*r+s*n+n/2,p.y=(i+1)*r+i*o+o/2},e.getObjectLength=function(e){var t=0;for(var n in e)t++;return t},e.swap=function(e,t,n){var o=e[t];e[t]=e[n],e[n]=o},e.randSort=function(e){for(var t=e.length,n=0;t>n;n++)this.swap(e,n,NumberTool.getRandInt(0,t-1))},e}();__reflect(ArrayTool.prototype,"ArrayTool");var DateTimer=function(e){function t(t,n){void 0===n&&(n=0);var o=e.call(this)||this;return o.delay=t,o.repeatCount=n,o}return __extends(t,e),t.prototype.start=function(){this.previous=egret.getTimer(),this.accTime=0,egret.startTick(this.update,this)},t.prototype.reset=function(){this.previous=egret.getTimer(),this.accTime=0,this.currentCount=0},t.prototype.stop=function(){egret.stopTick(this.update,this)},t.prototype.update=function(){for(this.curTime=egret.getTimer(),this.passTime=this.curTime-this.previous,this.previous=this.curTime,this.accTime+=this.passTime;this.accTime>=this.delay;)this.accTime-=this.delay,this.currentCount++,this.repeatCount>0&&this.currentCount==this.repeatCount&&(this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER_COMPLETE)),this.stop()),this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER));return!1},t}(egret.EventDispatcher);__reflect(DateTimer.prototype,"DateTimer");var DeviceUtils=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"IsWeb",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsIos",{get:function(){return"iOS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsAndroid",{get:function(){return"Android"==egret.Capabilities.os},enumerable:!0,configurable:!0}),t}(SingleClass);__reflect(DeviceUtils.prototype,"DeviceUtils");var EffectUtils;!function(e){function t(e,t){void 0===t&&(t=1e3),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.scaleX=4,e.scaleY=4,e.alpha=0,egret.Tween.get(e).to({scaleX:1,scaleY:1,alpha:1},200).wait(t).call(function(){e.parent&&e.parent.removeChild(e)})}function n(e,t){void 0===t&&(t=1e3);var n=e.y,o=new Date,r=o.getSeconds();egret.Tween.get(e).wait(t).to({y:n-100,alpha:.5},250).call(function(){var t=new Date,n=t.getSeconds(),o=n-r;console.log("tips显示时间="+o),e.parent&&e.parent.removeChild(e)})}function o(e,t,n,o){void 0===t&&(t=200),void 0===n&&(n=0),void 0===o&&(o=0);var r=e.y;egret.Tween.get(e,{loop:!0}).wait(n).to({y:r-e.height/3},t/2).to({y:r},t/2).wait(o)}function r(t){for(var n=t.length,o=400,r=0,a=0,i=.5,s=0;n>s;s++)r=s*(o*(1-i)),a=(n-s)*(o*(1-i)),e.bounce(t[s],o,r,a)}function a(e){egret.Tween.removeTweens(e)}function i(t){for(var n=t.length,o=0;n>o;o++)e.removeTween(t[o])}e.showMax2Min=t,e.showFload=n,e.bounce=o,e.bounceOneByOne=r,e.removeTween=a,e.removeObjsTween=i}(EffectUtils||(EffectUtils={}));var EventMananger=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventList={},t}return __extends(t,e),t.prototype.sendEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.eventList[e];if(null!=o)for(var r,a,i=o.length,s=0;i>s;s++){var p=o[s];r=p[0],a=p[1],r.apply(a,t)}},t.prototype.addEvent=function(e,t,n){var o=this.eventList[e];if(null==o)o=[],this.eventList[e]=o;else for(var r=o.length,a=0;r>a;a++)if(o[a][0]==t&&o[a][1]==n)return;o.push([t,n])},t.prototype.removeEvent=function(e,t,n){var o=this.eventList[e];if(null!=o)for(var r=o.length,a=r-1;a>=0;a--)o[a][0]==t&&o[a][1]==n&&o.splice(a,1);0==o.length&&(this.eventList[e]=null,delete this.eventList[e])},t}(SingleClass);__reflect(EventMananger.prototype,"EventMananger");var LayerManager=function(e){function t(){var t=e.call(this)||this;return t.rootLayer=new eui.UILayer,t.rootLayer.percentWidth=100,t.rootLayer.percentHeight=100,t.rootLayer.touchEnabled=!1,App.StageUtils.stage.addChild(t.rootLayer),t.sceneLayer=new eui.UILayer,t.sceneLayer.touchEnabled=!1,t.rootLayer.addChild(t.sceneLayer),t.popLayer=new eui.UILayer,t.popLayer.touchEnabled=!1,t.rootLayer.addChild(t.popLayer),t.lockLayer=new eui.UILayer,t.lockLayer.touchEnabled=!1,t.rootLayer.addChild(t.lockLayer),t.msgLayer=new eui.UILayer,t.msgLayer.touchEnabled=!1,t.rootLayer.addChild(t.msgLayer),t.tipLayer=new eui.UILayer,t.tipLayer.touchEnabled=!1,t.rootLayer.addChild(t.tipLayer),t}return __extends(t,e),t}(SingleClass);__reflect(LayerManager.prototype,"LayerManager");var MovieClipUtils=function(){function e(){}return e.getInstance=function(){return null==this.ins&&(this.ins=new e),this.ins},e.prototype.setResouce=function(e,t,n,o,r){this.loadObj=e,this.names=t,this.resPng=o,this.resJson=n,this.playTimes=r,this.load(this.initMovieClip)},e.prototype.initMovieClip=function(){var e=new egret.MovieClipDataFactory(this._mcData,this._mcTexture),t=e.generateMovieClipData(this.names),n=new egret.MovieClip(t);this.loadObj.addChild(n),n.gotoAndPlay(0,1),n.x=300,n.y=100,n.addEventListener(egret.Event.COMPLETE,function(e){egret.log("play over!"),n.parent.removeChild(n)},this);var o=0;n.addEventListener(egret.Event.LOOP_COMPLETE,function(e){egret.log("play times:"+ ++o)},this),n.addEventListener(egret.MovieClipEvent.FRAME_LABEL,function(e){egret.log("frameLabel:"+e.frameLabel)},this)},e.prototype.load=function(e){if(this._mcTexture=RES.getRes(this.resPng),this._mcData=RES.getRes(this.resJson),null!=this._mcTexture&&null!=this._mcData){var t=this;e.call(t)}},e}();__reflect(MovieClipUtils.prototype,"MovieClipUtils");var NumberTool=function(){function e(){}return e.formatTime=function(e){return e>=0&&10>e?"0"+e:e+""},e.getRandInt=function(e,t){return Math.round(Math.random()*(t-e))+e},e.formatCapital=function(e){return 0>=e||e>=10?"":["一","二","三","四","五","六","七","八","九"][e-1]},e.formatMoney=function(e){return e>=1e4||-1e4>=e?Math.round(e/100)/100+"万":e+""},e}();__reflect(NumberTool.prototype,"NumberTool");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}return e.prototype.getObject=function(){if(this.list.length>0)return this.list.shift();var e=egret.getDefinitionByName(this.className);return new e},e.prototype.returnObject=function(e){this.list.push(e)},e.getPool=function(t,n){if(void 0===n&&(n=0),!e.pool[t]&&(e.pool[t]=new e(t),0!=n))for(var o=egret.getDefinitionByName(t),r=e.pool[t],a=0;n>a;a++)r.returnObject(new o);return e.pool[t]},e.pool={},e}();__reflect(ObjectPool.prototype,"ObjectPool");var PanelManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.panelList={},t.panelClassList={},t.assetList={},t}return __extends(t,e),t.prototype.register=function(e,t,n){void 0===n&&(n=null),this.panelClassList[e]=t,this.assetList[e]=n},t.prototype.open=function(e,t,n,o,r,a){var i=this;void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=!0),void 0===r&&(r=!0),void 0===a&&(a=null);var s=this.panelList[e];if(null==s){var p=this.panelClassList[e];if(null==p)return null;s=new p,this.panelList[e]=s}null!=a&&s.recDataFun(a);var c=this.assetList[e];return null!=c?(App.LoadingLock.lock(),App.ResUtils.loadGroup(c,this,function(){App.LoadingLock.unlock(),null!=t&&null!=n&&s.once(egret.Event.ADDED_TO_STAGE,function(){t.call(n,!0)},i),App.PopUpManager.addPopUp(s,r,o)},null,10)):(null!=t&&null!=n&&s.once(egret.Event.ADDED_TO_STAGE,function(){t.call(n)},this),App.PopUpManager.addPopUp(s,r,o)),s},t.prototype.close=function(e){var t=this.panelList[e];return null!=t&&App.PopUpManager.removePopUp(t),t},t.prototype.getPanel=function(e){return this.panelList[e]},t.prototype.closeAllPanel=function(){App.ResUtils.deleteAllCallBack(),App.PopUpManager.removeAllPopUp(),App.LoadingLock.unlock()},t}(SingleClass);__reflect(PanelManager.prototype,"PanelManager");var PopUpManager=function(e){function t(){var t=e.call(this)||this;return t.lockCount=0,t.clickClose=[],t.createLockBg(),t}return __extends(t,e),t.prototype.addPopUp=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var o=App.LayerManager.popLayer;t&&(this.lockCount++,o.addChild(this.lockBg)),this.clickClose[this.lockCount]=n,o.addChild(e),this.curPanel=e},t.prototype.removePopUp=function(e){e.parent&&e.parent.removeChild(e);var t=App.LayerManager.popLayer;this.lockCount--,this.lockCount>0&&App.LayerManager.popLayer.numChildren>=2?(this.clickClose[this.lockCount]=!1,t.setChildIndex(this.lockBg,t.numChildren-2)):(this.lockCount=0,this.clickClose[this.lockCount]=!1,this.lockBg.parent&&this.lockBg.parent.removeChild(this.lockBg))},t.prototype.removeAllPopUp=function(){var e=App.LayerManager.popLayer;e.removeChildren(),this.lockBg.parent&&this.lockBg.parent.removeChild(this.lockBg),this.lockCount=0,this.clickClose.length=0},t.prototype.changeTransparency=function(e){this.lockBg.alpha=e},t.prototype.createLockBg=function(){this.lockBg=new egret.Sprite,this.lockBg.graphics.beginFill(0,.5);var e=App.StageUtils.stage;this.lockBg.graphics.drawRect(0,0,e.stageWidth,e.stageHeight),this.lockBg.graphics.endFill(),this.lockBg.touchEnabled=!0,this.lockBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},t.prototype.onTouchTap=function(){this.clickClose[this.lockCount]&&this.removePopUp(this.curPanel)},t}(SingleClass);__reflect(PopUpManager.prototype,"PopUpManager");var ResUtils=function(e){function t(){var t=e.call(this)||this;return t.initResVersion(),t.groupList=new Array,t.configList=new Array,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceLoadProgress,t),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),t}return __extends(t,e),t.prototype.initResVersion=function(){window&&window.version&&(RES.web.Html5VersionController.prototype.getVirtualUrl=function(e){var t=window.version;return e+=-1==e.indexOf("?")?"?ver="+t:"&ver="+t})},t.prototype.addConfig=function(e,t){this.configList.push([e,t])},t.prototype.loadConfig=function(e,t){this.onConfigComplete=e,this.onConfigCompleteTarget=t,this.loadNextConfig()},t.prototype.loadNextConfig=function(){if(0==this.configList.length)return this.onConfigComplete.call(this.onConfigCompleteTarget),this.onConfigComplete=null,void(this.onConfigCompleteTarget=null);var e=this.configList.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(e[0],e[1])},t.prototype.onConfigCompleteHandle=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},t.prototype.loadGroupQuiet=function(e,t){void 0===t&&(t=1);var n=this.combGroupName(e);RES.loadGroup(n,t)},t.prototype.loadGroup=function(e,t,n,o,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=1);var a=this.combGroupName(e);this.groupList[a]=[n,o,t],this.loadGroupQuiet(e,r)},t.prototype.onResourceLoadComplete=function(e){var t=e.groupName;if(console.log("加载资源组完成:"+t),this.groupList[t]){var n=this.groupList[t][0],o=this.groupList[t][2];null!=n&&n.call(o),this.deleteCallBack(t)}},t.prototype.onResourceLoadProgress=function(e){var t=e.groupName;if(this.groupList[t]){var n=this.groupList[t][1],o=this.groupList[t][2];null!=n&&n.call(o,e)}},t.prototype.onResourceLoadError=function(e){console.error(e.groupName+"资源组加载失败"),this.onResourceLoadComplete(e)},t.prototype.deleteCallBack=function(e){console.log("取消加载资源组回调:"+e),this.groupList[e]=null,delete this.groupList[e]},t.prototype.deleteAllCallBack=function(){for(var e in this.groupList)this.deleteCallBack(e)},t.prototype.combGroupName=function(e){var t="";if("string"==typeof e)t=e;else{for(var n=e.length,o=0;n>o;o++)t+=e[o];RES.createGroup(t,e)}return t},t}(SingleClass);__reflect(ResUtils.prototype,"ResUtils");var SceneManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneClassList={},t.sceneList={},t}return __extends(t,e),t.prototype.register=function(e,t){this.sceneClassList[e]=t},t.prototype.runScene=function(e,t){void 0===t&&(t=null),this.curScene&&App.LayerManager.sceneLayer.removeChild(this.curScene),e==SceneConst.HallScene&&egret.Capabilities.runtimeType==egret.RuntimeType.WEB;var n=this.sceneList[e];if(null==n){var o=this.sceneClassList[e];if(null==o)return console.error("当前场景不存在:",e),null;n=new o,this.sceneList[e]=n}return this.curScene=n,t&&this.curScene.setController(t),App.LayerManager.sceneLayer.addChild(this.curScene),this.curScene},t.prototype.getScene=function(e){return this.sceneList[e]},t.prototype.setScene=function(e,t){this.sceneList[e]=t},t.prototype.getCurScene=function(){return this.curScene},t}(SingleClass);__reflect(SceneManager.prototype,"SceneManager");var SoundManager=function(e){function t(){var t=e.call(this)||this;return t._allowPlayEffect=!0,t._allowPlayBGM=!0,t._effectVolume=1,t._bgmVolume=1,t}return __extends(t,e),t.prototype.getbgmChannel=function(){return this.bgmChannel},t.prototype.playEffect=function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=1),console.log("??????>>>>:",e),0!=this.allowPlayEffect){var o=null;if(null==o&&(o=RES.getRes(e)),o){o.type=egret.Sound.EFFECT;var r=o.play(t,n);r.volume=this._effectVolume}}},t.prototype.playBGM=function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=Number.MAX_VALUE),0!=this.allowPlayBGM&&null==this.bgmChannel){this.stopBGM();var o;null==o&&(o=RES.getRes(e)),o&&(o.type=egret.Sound.MUSIC,this.bgmChannel=o.play(t,n),this.bgmChannel.volume=this._bgmVolume)}},t.prototype.stopBGM=function(){this.bgmChannel&&(this.bgmChannel.stop(),this.bgmChannel=null)},Object.defineProperty(t.prototype,"allowPlayEffect",{get:function(){return this._allowPlayEffect},set:function(e){this._allowPlayEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowPlayBGM",{get:function(){return this._allowPlayBGM},set:function(e){this._allowPlayBGM=e,0==this._allowPlayBGM?this.stopBGM():this.playBGM(t.bgm)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectVolume",{get:function(){return this._effectVolume},set:function(e){this._effectVolume=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bgmVolume",{get:function(){return this._bgmVolume},set:function(e){this._bgmVolume=e,this.allowPlayBGM=!0,this.bgmChannel&&(this.bgmChannel.volume=this._bgmVolume)},enumerable:!0,configurable:!0}),t.bgm="music_mp3",t}(SingleClass);__reflect(SoundManager.prototype,"SoundManager");var StageUtils=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"stage",{get:function(){return egret.MainContext.instance.stage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageWidth",{get:function(){return this.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageHeight",{get:function(){return this.stage.stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"halfStageWidth",{get:function(){return this.stage.stageWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"halfStageHeight",{get:function(){return this.stage.stageHeight/2},enumerable:!0,configurable:!0}),t.prototype.runBrowserAdapt=function(){this.stage.addEventListener(egret.StageOrientationEvent.ORIENTATION_CHANGE,this.changeScaleMode,this)},t.prototype.changeScaleMode=function(){},t}(SingleClass);__reflect(StageUtils.prototype,"StageUtils");var StringTool=function(){function e(){}return e.trim=function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},e.formatNickName=function(e,t){void 0===t&&(t=10);var n=this.getStrLength(e);return n>t?e.substr(0,Math.round(t/2)-1)+"...":e},e.getStrLength=function(e){for(var t=0,n=0,o=0;o<e.length;o++)n=e.charCodeAt(o),n>127||n>=65&&90>=n?t+=2:t++;return t},e}();__reflect(StringTool.prototype,"StringTool");var Tips;!function(e){function t(e){r(e,!0)}function n(e){r(e)}function o(e){r(e)}function r(e,t){void 0===t&&(t=!1);var n=new egret.TextField;n.size=28,n.strokeColor=9653286;var o=new egret.Sprite;o.graphics.beginFill(9653286);var r=0,a=0,i=40;o.graphics.drawRoundRect(r,a,e.length*n.size+i,n.size+i,50),o.graphics.endFill(),o.alpha=.9,n.stroke=2,n.bold=!0,n.text=e,t?n.textColor=16774522:n.textColor=16774522,o.addChild(n),n.x=(o.width-n.width)/2,n.y=(o.height-n.height)/2,o.x=(App.StageUtils.stageWidth-o.width)/2,o.y=(App.StageUtils.stageHeight-o.height)/2,App.LayerManager.tipLayer&&App.LayerManager.tipLayer.addChild(o),EffectUtils.showFload(o,2e3)}e.error=t,e.info=n,e.warn=o}(Tips||(Tips={}));var WeixinSdk=function(){function e(){}return e.getWxCofig=function(){App.HttpSender.send(new Object,this.init,this)},e.init=function(t){this.isInit=!0;var n=new BodyConfig;n.appId=t.appId,n.timestamp=t.timestamp,n.nonceStr=t.nonceStr,n.signature=t.signature,this.imgUrl=t.imgUrlSt,n.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","startRecord","stopRecord","playVoice","onVoiceRecordEnd","uploadVoice","downloadVoice"],n.debug=!0,wx&&(wx.config(n),wx.ready(function(){e.wxShare()}))},e.wxShare=function(e){if(!this.isInit)return void console.log("微信接口初始化失败！");var t="游艺斯",n="最好玩的棋牌游戏",o="http://hjwl.vequn.org/share",r=this.imgUrl;e&&(t+=" 好友邀请",n+=" 房号:"+e,o+="?roomId="+e),console.log("微信分享");var a=new BodyMenuShareAppMessage;a.title=t,a.desc=n,a.link=o,a.imgUrl=r,a.success=function(){App.DataCenter.UserInfo.httpUserInfo.isFirstShare=!1},wx.onMenuShareAppMessage(a);var i=new BodyMenuShareTimeline;i.title=t,i.link=o,i.imgUrl=r,i.success=function(){},wx.onMenuShareTimeline(i)},e.isInit=!1,e}();__reflect(WeixinSdk.prototype,"WeixinSdk");var App=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.setFaceAnimation=function(e,t,n){console.log("asdad");var o=RES.getRes(e+"_json"),r=RES.getRes(e+"_png"),a=new egret.MovieClipDataFactory(o,r),i=new egret.MovieClip(a.generateMovieClipData(t));n.removeChildren(),n.addChild(i),i.x=-30,i.y=-40,i.gotoAndPlay(0,1),i.addEventListener(egret.Event.COMPLETE,function(e){console.log("》》》》》》》播放完成"),null!=i&&n.removeChild(i)},this)},t.prototype.startUp=function(){if(t.DeviceUtils.IsWeb&&(t.StageUtils.changeScaleMode(),t.StageUtils.runBrowserAdapt()),t.DeviceUtils.IsNative){var e={current:10,total:10};JSON.stringify(e)}t.DeviceUtils.IsNative&&this.setInterfaces(),this.registerController(LoginController.NAME,new LoginController),this.registerController(HallController.NAME,new HallController),this.registerController(DKGameController.NAME,new DKGameController);var n=t.SceneManager;n.register(SceneConst.LoginScene,LoginScene),n.register(SceneConst.HallScene,HallScene),n.register(SceneConst.DKGameScene,DKGameScene);
var o=t.PanelManager;o.register(PanelConst.PreloadPanel,PreloadPanel),o.register(PanelConst.CroomPanle,CroomPanels),o.register(PanelConst.EroomPanel,ERoomPanel),o.register(PanelConst.SetPanel,LbSetPanel),o.register(PanelConst.PayPanel,PayPanel),o.register(PanelConst.MsgPanel,MessagePanel),o.register(PanelConst.RulePanel,RulePanel),o.register(PanelConst.ScorePanel,ScorePanel),o.register(PanelConst.PersionInfoPanel,PersionInfoPanel),o.register(PanelConst.DkSingResultUI,DkSingResultUI),o.register(PanelConst.DkResultUI,DkResultUI),o.register(PanelConst.ChatPanel,ChatPanel),o.register(PanelConst.InvitePanel,InvitePanel),this.addEvent(t.EVENT_NATIVE_SHAKE,this.nativeShake,this),this.addEvent(t.EVENT_SET_WEB_WXSHARE,this.setWebWxShare,this),this.addEvent(t.EVENT_NATIVE_WXSHARE,this.nativeWxShare,this),this.sendEvent(LoginController.EVENT_SHOW_LOGIN)},t.prototype.setInterfaces=function(){egret.ExternalInterface.addCallback("quitApp",function(e){console.log("message form native : "+e);var n=t.MsgBoxManager.getBoxA();n.showMsg("是否关闭游戏"),n.ok=function(){egret.ExternalInterface.call("quitApp","quitApp")}})},t.prototype.nativeWxShare=function(e){},t.prototype.nativeShake=function(e){void 0===e&&(e=1500),egret.ExternalInterface.call("shake",e+"")},t.prototype.setWebWxShare=function(e,t,n,o){},t.getController=function(e){return t.getInstance().getController(e)},Object.defineProperty(t,"DataCenter",{get:function(){return DataCenter.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeviceUtils",{get:function(){return DeviceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResUtils",{get:function(){return ResUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LayerManager",{get:function(){return LayerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PopUpManager",{get:function(){return PopUpManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MsgBoxManager",{get:function(){return MessageBoxManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EventManager",{get:function(){return EventMananger.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HttpSender",{get:function(){return HttpSender.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LoadingLock",{get:function(){return LoadingLock.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PanelManager",{get:function(){return PanelManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SceneManager",{get:function(){return SceneManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameSocket",{get:function(){return SocketManager.getInstance().gameSocket},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverSocket",{get:function(){return SocketManager.getInstance().serverSocket},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pushSocket",{get:function(){return SocketManager.getInstance().pushSocket},enumerable:!0,configurable:!0}),t.EVENT_NATIVE_SHAKE="EVENT_NATIVE_SHAKE",t.EVENT_SET_WEB_WXSHARE="EVENT_SET_WEB_WXSHARE",t.EVENT_NATIVE_WXSHARE="EVENT_NATIVE_WXSHARE",t}(BaseApp);__reflect(App.prototype,"App");var AssetConst=function(){function e(){}return e.Preload="lb_preload",e.Invite="invite",e.Game="game",e.ActFace="actface",e.Share="share",e.Voice="voice",e.Replay="replay",e.Sound_GuangDong="sound_guangdong",e.Sound_PuTong="sound_putong",e.Sound_Other="sound_other",e.Sound_BGM="sound_bgm",e.Bag="bag",e.Email="email",e.Feedback="feedback",e.Rank="rank",e.HallShare="hall_share",e.Shop="shop",e.Sign="sign",e.Lucky="lucky",e.Fuli="fuli",e.Jjj="jjj",e.Result="result",e.Chat="chat",e.Card="card",e.Common="common",e.ChatFace="chatFace",e.InputRoom="input_room",e.Qrcode="qrcode",e.Res_13Dao="preload",e}();__reflect(AssetConst.prototype,"AssetConst");var EventConst=function(){function e(){}return e.SocketConnect="SocketConnect",e.StartReconnect="StartReconnect",e.SocketNotConnect="SocketNotConnect",e.SocketIOError="SocketIOError",e.SocketClose="SocketClose",e.GameStateChange="GameStateChange",e.GameConfigChange="GameConfigChange",e}();__reflect(EventConst.prototype,"EventConst");var PanelConst;!function(e){e[e.RulePanel=0]="RulePanel",e[e.CreateRoomPanel=1]="CreateRoomPanel",e[e.PreloadPanel=2]="PreloadPanel",e[e.ScorePanel=3]="ScorePanel",e[e.MsgPanel=4]="MsgPanel",e[e.SetPanel=5]="SetPanel",e[e.PersionInfoPanel=6]="PersionInfoPanel",e[e.CroomPanle=7]="CroomPanle",e[e.EroomPanel=8]="EroomPanel",e[e.PayPanel=9]="PayPanel",e[e.DkSingResultUI=10]="DkSingResultUI",e[e.DkResultUI=11]="DkResultUI",e[e.ChatPanel=12]="ChatPanel",e[e.InvitePanel=13]="InvitePanel",e[e.RuleRoom=14]="RuleRoom",e[e.topGame=15]="topGame"}(PanelConst||(PanelConst={}));var SceneConst;!function(e){e[e.PreloadScene=0]="PreloadScene",e[e.LoginScene=1]="LoginScene",e[e.HallScene=2]="HallScene",e[e.DKGameScene=3]="DKGameScene",e[e.ThridGameScene=4]="ThridGameScene"}(SceneConst||(SceneConst={}));var DataCenter=function(e){function t(){var t=e.call(this)||this;return t.sendMsg=!1,t.logoUrl="http://hjwl.vequn.org/image/logo.png",t.UserInfo=new UserInfo,t.ServerInfo=new ServerInfo,t.GameInfo=new GameInfo,t.debugInfo=new DebugInfo,t.colorInfo=new ColorInfo,t.marqueeInfo=new MarqueeInfo,t.shareInfo=new ShareInfo,t}return __extends(t,e),t}(SingleClass);__reflect(DataCenter.prototype,"DataCenter");var BagInfo=function(){function e(){this.sceneGroupList=[],this.scenePngList=[],this.init()}return e.prototype.init=function(){this.act=ItemType["default"],this.face=ItemType["default"],this.scene=ItemType["default"],this.initScene()},e.prototype.initScene=function(){this.sceneGroupList=["defaultScene","youselfScene","vipScene"],this.scenePngList=["game_bg_jpg","game_bg_jpg","game_bg_jpg"];for(var e=this.sceneGroupList.length,t=0;e>t;t++)RES.createGroup(this.sceneGroupList[t],[this.scenePngList[t]])},e.prototype.getSceneGroupName=function(){return this.sceneGroupList[this.scene]},e.prototype.getScenePngName=function(){return this.scenePngList[this.scene]},e}();__reflect(BagInfo.prototype,"BagInfo");var ItemType;!function(e){e[e["default"]=0]="default",e[e.youself=1]="youself",e[e.vip=2]="vip"}(ItemType||(ItemType={}));var ColorInfo=function(){function e(){this.LoseRed=15467282,this.WinGreen=4908864}return e}();__reflect(ColorInfo.prototype,"ColorInfo");var DebugInfo=function(){function e(){this.testList=["o2P0bwV8zuxfrVSsmy1ZJf7USFw0","o2P0bwSorAjxiVlmvGzNmagjX3Z8","o2P0bwSTs13BEOZCrzGiq2wKvr6I","o2P0bwVIsXa8H2ZN-K8gvUo5ksiU","o2P0bwTIsCK1M4Aqy6YuxGPuxPXQ"],this.password="112233"}return Object.defineProperty(e.prototype,"isDebug",{get:function(){return null!=egret.getOption("debug")&&""!=egret.getOption("debug")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLocalPhp",{get:function(){return parseInt(egret.getOption("local"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"account",{get:function(){return this.testList[egret.getOption("debug")]},enumerable:!0,configurable:!0}),e}();__reflect(DebugInfo.prototype,"DebugInfo");var ErrorCode;!function(e){function t(e,t){var n=e+(t?"_"+t.toString():"");return o[n]?o[n]:"未定义的错误码:"+n}function n(e){return r[e]}var o=[],r=[];o["100_3_9"]="当前session被占用",o["100_3_3"]="密码错误",o["100_3_19"]="没有登录Z服务器",o["104_1_1_1"]="开房卡不足",o["104_1_1_2"]="桌子数达到上限",o["104_1_1_3"]="创建数量达到上限",o["104_1_1_4"]="暗号已存在或为空",o["102_4_1_1"]="房间不存在，请确认所输入的房间号是否正确",o["102_4_1_2"]="房间人满",o["102_4_1_3"]="金币不足",o["102_4_1_4"]="位置上已经有人",o["102_4_1_5"]="XXX太多",o["102_4_1_-3"]="资金与约定金不足!",o["102_4_1_-11"]="被房主踢出!",o["102_4_1_-12"]="强退了其他房间!",o["102_4_1_-13"]="人满!",o["102_4_1_-14"]="房主不在线!",o["102_4_1_-15"]="房间已过期，请续费!",o["102_4_1_-11"]="你被房主请离房间，3分钟不能进入。",o["102_4_1_-12"]="你强退了其他房间，所以不能进入",o["102_4_1_-13"]="房间人员已满，不能加入房间",o["104_2_1"]="房间不存在，请确认所输入的房间号是否正确",o["102_11_1"]="无空闲的桌子",r["100_5_0"]="登录",r["100_3_9"]="当前session被占用",r["100_3_3"]="密码错误",r["100_3_19"]="没有登录Z服务器",r["100_2_1"]="登陆成功",r["104_1_0"]="创建房间",r["104_1_1"]="创建房间返回",r["104_2_0"]="查找房间",r["104_2_1"]="查找房间返回",r["104_4_0"]="通知桌子结束",r["104_4_1"]="通知房主房间结束",r["102_4_0"]="进入房间",r["102_4_1"]="进入房间返回",r["102_5_0"]="退出房间",r["102_5_1"]="广播退出房间",r["180_51_0"]="获取庄家位置(游戏开始)",r["180_52_0"]="发牌",r["180_53_0"]="玩家摸牌(杠)",r["180_54_0"]="玩家请求操作",r["180_55_0"]="玩家叫牌",r["180_56_0"]="响应玩家操作",r["180_57_0"]="通知玩家出牌(吃碰牌后通知出牌)",r["180_58_0"]="游戏结算",e.getCodeText=t,e.cn=n}(ErrorCode||(ErrorCode={}));var GameInfo=function(){function e(){this.isReCon=!1}return e}();__reflect(GameInfo.prototype,"GameInfo");var UserPosition;!function(e){e[e.NULL=-1]="NULL",e[e.Down=0]="Down",e[e.R=1]="R",e[e.Up=2]="Up",e[e.L=3]="L"}(UserPosition||(UserPosition={}));var GoldRoomInfo=function(){function e(){this.infoList=[]}return e.prototype.readData=function(e){for(var t=e.length,n=0;t>n;n++){var o=ProtocolHttp.GoldRoomJson;o=e[n],o.versusroomcfg=JSON.parse(e[n].versusroomcfg),this.infoList.push(o)}},e.prototype.getData=function(e,t){for(var n=this.infoList.length,o=0;n>o;o++){var r=this.infoList[o];if(r.GameID==e+""&&r.level==t+"")return r}return null},e}();__reflect(GoldRoomInfo.prototype,"GoldRoomInfo");var MarqueeInfo=function(){function e(){this.init()}return e.prototype.init=function(){this.gameMarquee=["%1【%2】的%3牌技果然精湛，竟然以%4结束了这场牌局！","%1【%2】的%3出其不意的以%4力压群雄！","%1【%2】惊现%4牌型,%3在牌技的道路上又更近了一步！"],this.messageMarquee=[]},e.prototype.setMsgMarquee=function(e){for(var t=0;t<e.length;t++)this.messageMarquee.push(e[t].content)},e.prototype.getGameMqrquee=function(e,t,n,o){var r=this.gameMarquee[NumberTool.getRandInt(0,this.gameMarquee.length-1)];return r=r.replace("%1",decodeURIComponent(e)),r=r.replace("%2",t.toString()),r=r.replace("%3",n),r=r.replace("%4",o)},e}();__reflect(MarqueeInfo.prototype,"MarqueeInfo");var ReplayInfo=function(){function e(){this.bReplay=!1}return e}();__reflect(ReplayInfo.prototype,"ReplayInfo");var ServerInfo=function(){function e(){this.GAME_SERVER="ws://192.168.2.106:9001",this.WX_URL=""}return Object.defineProperty(e.prototype,"WEB_URL",{get:function(){return"http://hjwl.vequn.org/share?url=hjwl.vequn.org"},enumerable:!0,configurable:!0}),e}();__reflect(ServerInfo.prototype,"ServerInfo");var ShareInfo=function(){function e(){}return Object.defineProperty(e.prototype,"roomId",{get:function(){return egret.getOption("roomId")},enumerable:!0,configurable:!0}),e}();__reflect(ShareInfo.prototype,"ShareInfo");var ShopInfo=function(){function e(){}return e}();__reflect(ShopInfo.prototype,"ShopInfo");var ShopType;!function(e){e[e.Diamon=1]="Diamon",e[e.Item=2]="Item",e[e.Vip=7]="Vip",e[e.Gold=8]="Gold",e[e.ReNew=9]="ReNew",e[e.OpenDesk=10]="OpenDesk"}(ShopType||(ShopType={}));var UserInfo=function(){function e(){this.userList={}}return e.prototype.addUser=function(e){this.userList[e.roleId]?console.log("用户重复添加:",e.roleId):this.userList[e.roleId]=e},e.prototype.getMyUserVo=function(){return this.getUser(this.httpUserInfo.openId)},e.prototype.initPlayerApply=function(){for(var e in this.userList){var t=this.userList[e];t.isAgree=0}},e.prototype.setMyUserVo=function(e){this.httpUserInfo=new UserVO,e&&""!=e&&(this.httpUserInfo.headImgUrl=App.DataCenter.UserInfo.httpUserInfo.headImgUrl,this.httpUserInfo.nickName=App.DataCenter.UserInfo.httpUserInfo.nickName,this.httpUserInfo.roleId=App.DataCenter.UserInfo.httpUserInfo.roleId,this.httpUserInfo.gold=App.DataCenter.UserInfo.httpUserInfo.gold,this.httpUserInfo.openId=App.DataCenter.UserInfo.httpUserInfo.openId,this.httpUserInfo.sex=App.DataCenter.UserInfo.httpUserInfo.sex,this.addUser(this.httpUserInfo))},e.prototype.getUser=function(e){return this.userList[e]},e.prototype.getUserForSeatNo=function(e){var t;for(var n in this.userList)if(t=this.userList[n],t.seat==e)return t;return null},e.prototype.isExist=function(e){return this.getUser(e)?!0:!1},e.prototype.getUserBySeatID=function(e){for(var t in this.userList)if(this.userList[t].seatID==e)return this.userList[t];return null},e.prototype.deleteUser=function(e){delete this.userList[e]},e.prototype.deleteAllUserExcptMe=function(){for(var e in this.userList)e!=this.httpUserInfo.openId&&delete this.userList[e]},e.prototype.deleteAllUser=function(){for(var e in this.userList)delete this.userList[e]},e.prototype.getUserNum=function(){return ArrayTool.getObjectLength(this.userList)},e.prototype.deleteAllSeatMap=function(){this.httpUserInfo.seatMap={},this.httpUserInfo.room={}},e}();__reflect(UserInfo.prototype,"UserInfo");var WelfareInfo=function(){function e(){this.benefit_cnt=0,this.benefitMax=3,this.benefitflag=0,this.broke_money=0}return e.prototype.isCanApply=function(){return!0},e}();__reflect(WelfareInfo.prototype,"WelfareInfo");var Main=function(_super){function Main(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Main,_super),Main.prototype.createChildren=function(){_super.prototype.createChildren.call(this);var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),App.ResUtils.addConfig(window.ossServer+"resource/default.res.json",window.ossServer+"resource/"),App.ResUtils.loadConfig(this.load13Dao,this)},Main.prototype.load13Dao=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig(window.ossServer+"resource/games/13dao/resource/default.res.json",window.ossServer+"resource/games/13dao/resource/")},Main.prototype.onConfigComplete=function(e){var t=new eui.Theme(window.ossServer+"resource/default.thm.json",this.stage);t.once(eui.UIEvent.COMPLETE,this.onThemeLoadComplete1,this)},Main.prototype.onThemeLoadComplete1=function(event){if(egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE){var url_1=RES.getVersionController().getVirtualUrl(window.ossServer+"resource/games/13dao/main.min.js");RES.getResByUrl(url_1,function(){eval("require")(url_1),this.onThemeLoadComplete(),console.error("加载完毕")},this)}else this.onThemeLoadComplete()},Main.prototype.onThemeLoadComplete=function(){App.ResUtils.loadGroup(AssetConst.Preload,this,this.onPreloadComplete)},Main.prototype.onPreloadComplete=function(e){this.startCreateScene()},Main.prototype.startCreateScene=function(){egret.OrientationMode.LANDSCAPE,App.getInstance().startUp();var e=egret.localStorage.getItem("sk_music");if(e){var t=JSON.parse(e);App.SoundManager.bgmVolume=t[0]?0:1,App.SoundManager.effectVolume=t[1]?0:1}},Main}(eui.UILayer);__reflect(Main.prototype,"Main");var ProtocolData=function(){function e(){}return e.commond={cmd:"",game:""},e.gameId={normal:0,variety:1,thirteenth:2,hall:-1},e.sendLogin={cmd:"1",game:"-1",msg:[{openId:"owUlNw9vcKUUlqxxSYg54i1ATAsc",nickname:"等风来"}]},e.revLogin={cmd:2,game:-1,msg:[]},e.CMD131002={cmd:"131002",roomId:0},e.CMD131001={cmd:"131001",time:15},e}();__reflect(ProtocolData.prototype,"ProtocolData");var ProtocolHead=function(){function e(){}return e.SendCmd1=101002,e.CMD101002=101002,e.CMD100006=100006,e.SendCmd3=131001,e.CMD131001=131001,e.SendCmd6=131002,e.CMD131002=131002,e.CMD131003=131003,e.CMD131005=131005,e}();__reflect(ProtocolHead.prototype,"ProtocolHead");var ProtocolHttp=function(){function e(){}return e.httpHead={ver:"1.6.1",AssetID:1,mainID:100},e.rev_z_login={ret:0,desc:"",action:"",mainID:0,AssetID:0,data:{hadinvited:1,deskTime:"",user:"",name:"",sex:-1,skey:"",avater_url:"",password:"",is_overtime:0,last_ip:"",uid:0,ip:"",port:"",prushport:"",excluroom_name:"",excluroom_code:""}},e.send_z_login={action:"Login",param:{}},e.send_z_loginweixin={action:"LoginWeiXin",param:{code:""}},e.send_z_loginapp={action:"LoginApp",param:{code:"",refToken:""}},e.send_z_godrank={action:"Billboard",param:{playerID:0}},e.send_z_richrank={action:"Wealthboard",param:{playerID:0}},e.send_z_scorerank={action:"Integrationboard",param:{playerID:0}},e.send_z_avard={action:"Receiveprize",skey:"74db1b6807182ffa1bf7a04cbc6a4562",uid:0,param:[]},e.send_z_combat={action:"CombatGains",param:{playerID:0}},e.send_z_combatdetail={action:"CombatGainsdetail",param:{deskno:0,buildDate:0,playerID:0,roomid:0}},e.send_z_feedback={skey:"",uid:0,action:"Feedbacks",param:{content:""}},e.send_z_buyprop={action:"BuyProp",skey:"",uid:0,param:{propid:0}},e.send_z_buypayment={action:"Payment",skey:"",uid:0,param:{}},e.get_z_back={action:"GetBackpack",skey:"",uid:0,param:{}},e.send_z_goodsList={action:"GoodsList",skey:"",uid:0,param:{type:0}},e.send_z_marquee={action:"Marquee",param:[]},e.send_z_replayCombatGain={action:"ReplayCombatGain",skey:"",uid:0,param:{replaycode:0}},e.send_z_Pay={action:"ApplyABPay",skey:"",uid:0,param:{goodsid:0,pay_type:0}},e.send_z_emailList={action:"GetEmailByUser",skey:"",uid:0,param:[]},e.send_z_emailDetail={action:"ReadEmail",skey:"",uid:0,param:{eid:0}},e.send_z_getEmailGoods={action:"ReceiveEmail",skey:"",uid:0,param:{eid:0}},e.send_z_getAllEmailGoods={action:"ReceiveEmail",skey:"",uid:0,param:[]},e.send_z_delAllEmail={action:"OneKeyDel",skey:"",uid:0,param:[]},e.send_z_checkMail={action:"CheckMail",skey:"",uid:0,param:[]},e.send_z_checkShareAward={action:"CheckShare",skey:"",uid:0,param:[]},e.send_z_signInList={action:"SignInPriceList",skey:"",uid:0,param:[]},e.send_z_signInDetail={action:"SignInPricedetail",skey:"",uid:0,param:{id:0}},e.send_z_lotteryList={action:"LotteryDrawList",skey:"",uid:0,param:[]},e.send_z_lotteryDetail={action:"LotteryDrawDetail",skey:"",uid:0,param:[]},e.send_z_bag={action:"BackPack",skey:"",uid:0,param:{type:0}},e.send_z_shareCount={action:"ShareCount",skey:"",uid:0,param:[]},e.send_z_shareDetial={action:"ShareDetail",skey:"",uid:0,param:{mid:0,type:0,sharenum:0}},e.send_z_one_insertShare={action:"InsertShare",skey:"",uid:0,param:{pid:0,sid:0}},e.send_z_InsertShare={action:"UpdateShare",skey:"",uid:0,param:{}},e.aibData={transId:"",retFunc:"callback"},e.send_z_CheckVip={action:"CheckVip",skey:"",uid:0,param:[]},e.send_z_WelfareList={action:"WelfareList",skey:"",uid:0,param:[]},e.send_z_AlmsList={action:"AlmsList",skey:"",uid:0,param:[]},e.send_z_openVip={action:"ApplyABPay",skey:"",uid:0,param:{goodsid:0,pay_type:0}},e.sendGoldRoom={action:"Getvenue",skey:"",uid:0,param:[]},e.GoldRoomJson={GameID:"",base_money:"",id:"",level:"",max_money:"",min_money:"",versusroomcfg:{hasBenefit:!0,benefitLower:2e3,benefitList:[2500,3e3,3500],benefitMaxCnt:3,gameConfig:{gameType:1,maiMaNum:0}}},e.sendExclusiveRoom={action:"GetExclusiveRoom",skey:"",uid:"",param:[]},e.SendEditExclusiveRoom={action:"EditExclusiveRoom",skey:"",uid:"",param:{gameConfig:{},deskName:"",basePoint:0,playCount:0,chip:0,deposit:0}},e.ShareByQrcode={action:"ShareByQrcode",skey:"",uid:0,param:{deskCode:"",deskId:0}},e.AddDesk={action:"AddDesk",uid:0,skey:"",param:{basePoint:0,ip:"",port:0}},e.GetRankList={action:"Billboard",skey:"",uid:0,param:[]},e.GetScoreList={action:"CombatGains",skey:"",uid:0,param:[]},e.GetScoreDetailList={action:"CombatGainsdetail",skey:"",uid:0,param:{deskBuildDate:0,deskCode:0}},e}();__reflect(ProtocolHttp.prototype,"ProtocolHttp");var UserVO=function(){function e(){this.score=0,this.changeCard=[],this.owner=!1,this.isAgree=0,this.isFirstShare=!1,this.seat=0,this.seatMap={},this.user={},this.room={},this.creator={},this.roomInfo=0}return e}();__reflect(UserVO.prototype,"UserVO");var ApplyDisRoomView=function(e){function t(){var t=e.call(this)||this;return t.maxImum=730,t.flag=0,t.timer=new egret.Timer(31),t.addEventListener(egret.Event.COMPLETE,t.uiComplete,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t.skinName="ApplyDisRoomSkin",t}return __extends(t,e),t.prototype.uiComplete=function(){this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.hslider_time.maximum=this.maxImum,this.myOpenId=App.DataCenter.UserInfo.httpUserInfo.openId,this.hslider_time.touchEnabled=!1,this.init(),this.hslider_time.scaleX=1},t.prototype.onTimer=function(){this.flag++,this.flag>this.maxImum||(this.hslider_time.scaleX=1-this.flag/730)},t.prototype.onRemoved=function(){},t.prototype.init=function(){this.stop(),this.img_ing.visible=!1,this.group_btn.visible=!0},t.prototype.myFresh=function(e){var t=App.DataCenter.UserInfo.httpUserInfo.user;console.log(">>>所有用户信息:",t),this.visible=!0,this.hownumpeople.text="1/4人";for(var n in t)t[n].seat==e&&(this.shengqingzhe.text=t[n].player.nickname.substr(0,5))},t.prototype.freshPlayer=function(e,t){Number(t);this.visible=!0;var n=0;for(var o in e)1==e[o]&&n++;this.hownumpeople.text=n+"/4人"},t.prototype.updateUI=function(e){parseInt(e.seat)},t.prototype.startTime=function(e){if(!this.timer.running){this.timer.start();var t=1e3*(30-parseInt(e));this.flag=Math.ceil(t/41)}},t.prototype.stop=function(){this.timer.stop()},t.prototype.initTimer=function(){this.timer.stop(),this.timer.reset(),this.hslider_time.scaleX=0,this.flag=0,this.visible=!1},t.prototype.touch=function(){this.addEventListener("touchTap",this.onTouch,this)},t.prototype.onTouch=function(e){switch(e.target){case this.btn_yes:console.log("点击同意"),this.ok&&this.ok.call(this.thisObject),this.hideAndRecycle(),this.img_ing.visible=!0,this.group_btn.visible=!1;break;case this.btn_no:console.log("点击拒绝"),this.cancel&&this.cancel.call(this.thisObject),this.hideAndRecycle(),this.img_ing.visible=!0,this.group_btn.visible=!1}},t.prototype.hideAndRecycle=function(){egret.Tween.removeTweens(this),this.ok=null,this.cancel=null,this.thisObject=null},t.NAME="ApplyDisRoomSkin",t}(eui.Component);__reflect(ApplyDisRoomView.prototype,"ApplyDisRoomView");var DragonBonesManager=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.startDragon=function(e,t,n,o,r,a,i,s,p,c,l,h,u){void 0===l&&(l=1),void 0===h&&(h=!1),void 0===u&&(u="dragonbones");try{null==this.factory&&(this.factory=new dragonBones.EgretFactory);var g=this.factory.getDragonBonesData(t);if(null==g){var d=RES.getRes(n+"_ske_json"),m=dragonBones.DataParser.parseDragonBonesData(d);this.factory.addDragonBonesData(m)}var f=this.factory.getTextureAtlas(t);if(null==f){var v=new dragonBones.EgretTextureAtlas(RES.getRes(r+"_tex_png"),RES.getRes(o+"_tex_json"));this.factory.addTextureAtlas(v)}var y=this.factory.buildArmatureDisplay(a);y.animation.timeScale=l,y.animation.play(i,c),y.x=s,y.y=p,y.once(egret.Event.COMPLETE,function(){h||(e.dispatchEventWith("DragonBonesComplete",!1),y.animation.reset(),null!=y&&null!=y.parent&&y.parent.removeChild(y),y=null)},this),y.name=u,e.addChild(y)}catch(C){}},e}();__reflect(DragonBonesManager.prototype,"DragonBonesManager");var GameData=function(){function e(){}return e.peopleNum=[],e.offLinePlayer=[],e.tishiCardArr=[],e.isAgree=[],e.isTolal=!1,e.isplayerCardSeat=!1,e.roomstats=2,e.isWatcher=!0,e}();__reflect(GameData.prototype,"GameData");var LoadingLock=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.overTimer=new egret.Timer(1e4,1),t}return __extends(t,e),t.prototype.lock=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),this.callBack=e,this.thisObject=t,this.startOverTimer(),null==this.mc){var n=RES.getRes("loadMc_json"),o=RES.getRes("loadMc_png"),r=new egret.MovieClipDataFactory(n,o);this.mc=new egret.MovieClip(r.generateMovieClipData("load")),this.mc.x=(App.StageUtils.stageWidth-this.mc.width)/2,this.mc.y=(App.StageUtils.stageHeight-this.mc.height)/2}null==this.rect&&(this.rect=new eui.Rect,this.rect.width=App.StageUtils.stageWidth,this.rect.height=App.StageUtils.stageHeight,this.rect.touchEnabled=!0,this.rect.alpha=0),App.LayerManager.lockLayer.addChild(this.rect),App.LayerManager.lockLayer.addChild(this.mc),this.mc.gotoAndPlay("roll",-1)},t.prototype.unlock=function(){this.callBack=null,this.thisObject=null,this.stopOverTimer(),this.mc&&this.mc.parent&&this.mc.parent.removeChild(this.mc),this.rect&&this.rect.parent&&this.rect.parent.removeChild(this.rect)},t.prototype.startOverTimer=function(){this.overTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),this.overTimer.reset(),this.overTimer.start()},t.prototype.stopOverTimer=function(){this.overTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerComplete,this),this.overTimer.stop()},t.prototype.onTimerComplete=function(){null!=this.callBack&&null!=this.thisObject&&this.callBack.call(this.thisObject),this.unlock()},t}(SingleClass);__reflect(LoadingLock.prototype,"LoadingLock");var MessageBox=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t}return __extends(t,e),t.prototype.showMsg=function(e){null==this.parent&&(App.LayerManager.msgLayer.addChild(this),this.horizontalCenter=0,this.verticalCenter=0),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.msgLabel.text=e,"房间解散失败"==e?this.msgLabel.size=35:this.msgLabel.size=31},t.prototype.onTouch=function(e){switch(e.target){case this.okBtn:this.ok&&this.ok.call(this.thisObject),this.hideAndRecycle();break;case this.cancelBtn||this.close:this.cancel&&this.cancel.call(this.thisObject),this.hideAndRecycle()}},t.prototype.closeBt=function(){this.hideAndRecycle()},t.prototype.leftTitle=function(e){this.cancelBtn.label=e},t.prototype.centerTitle=function(e){this.okBtn.label=e},t.prototype.rightTitle=function(e){this.okBtn.label=e},t.prototype.hideAndRecycle=function(){egret.Tween.removeTweens(this),this.ok=null,this.cancel=null,this.thisObject=null,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.hide()},t.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},t.NAME="MessageBox",t}(eui.Component);__reflect(MessageBox.prototype,"MessageBox");var MessageBoxManager=function(e){function t(){var t=e.call(this)||this;return t.boxPool=ObjectPool.getPool(MessageBox.NAME),t}return __extends(t,e),t.prototype.getBoxA=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxASkin",e},t.prototype.getBoxB=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxBSkin",e},t.prototype.getBoxC=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxCSkin",e},t.prototype.getBoxD=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxDSkin",e},t.prototype.getBoxAD=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxADSkin",e},t.prototype.getBoxOC=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxOCSkin",e},t.prototype.getPlayerApplyBox=function(){var e=this.boxPool.getObject();return e.skinName="MessageBoxOCSkin",e},t.prototype.recycle=function(e){this.boxPool.returnObject(e)},t.prototype.recycleAllBox=function(){for(var e=App.LayerManager.msgLayer,t=e.numChildren,n=t-1;n>=0;n--){var o=e.getChildAt(n);o&&o instanceof MessageBox&&o.hideAndRecycle()}},t}(SingleClass);__reflect(MessageBoxManager.prototype,"MessageBoxManager");var PanelBg=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);__reflect(PanelBg.prototype,"PanelBg");var RecordBox=function(e){function t(){var t=e.call(this)||this;return t.recordTimer=new egret.Timer(500),t.currentNumber=0,t.skinName="RecordBoxSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.recordTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimerEventHandler,this),this.recordTimer.start()},t.prototype.onTimerEventHandler=function(e){if(this.currentNumber==this.recordImageGroup.numChildren){for(var t=0;t<this.recordImageGroup.numChildren;t++){var n=this.recordImageGroup.getChildAt(t);n.visible=!1}return void(this.currentNumber=0)}var o=this.recordImageGroup.getChildAt(this.currentNumber);o.visible=!0,this.currentNumber++},t}(eui.Component);__reflect(RecordBox.prototype,"RecordBox");var ChatPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="ChatPanelSkin",t}return __extends(t,e),t.prototype.onEnable=function(){var e=this;this.setCenter(),this.radioRbt.group.addEventListener(eui.UIEvent.CHANGE,this.changeViewStack,this),this.radioFace.group.addEventListener(eui.UIEvent.CHANGE,this.changeViewStack,this),this.radioFace.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setFaceUserfulData,this),this.usefulList.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chatBeTouched,this),this.faceList.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.faceList.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.target instanceof eui.Image){var n=t.target;console.log("lab.source.toString():",n.source.toString()),e.sendUseful(1,n.source.toString())}},this),this.vs.selectedIndex?this.setFaceUserfulData():this.setUsefulData()},t.prototype.chatBeTouched=function(e){console.log(e.target);var t=e.target;t.text&&this.sendUseful(0,t.text)},t.prototype.changeViewStack=function(e){var t=e.target;this.vs.selectedIndex=t.selectedValue;var n=this.vs.selectedIndex?!1:!0;this.txtGroup.visible=n,this.faceGroup.visible=!n},t.prototype.childrenCreated=function(){this.usefulList.dataProvider.removeAll(),this.setUsefulData()},t.prototype.setUsefulData=function(){this.chatImgBg.visible=!1,this.txtGroup.visible=!0,this.faceGroup.visible=!1;var e=["大家好，很高兴见到大家。","快点吧，我等得花都谢了！","不要走，决战到天亮。","你是帅哥还是美女啊。","君子报仇，十盘不算晚。","打错了，呜呜呜呜。"];this.usefulList.itemRenderer=UsefuleItem,this.usefulList.dataProvider=new eui.ArrayCollection(e)},t.prototype.sendUseful=function(e,t){var n=App.DataCenter.UserInfo.httpUserInfo.sex,o=App.DataCenter.UserInfo.httpUserInfo.seat,r={cmd:131009,seat:o,sex:n,flag:e,message:t};App.gameSocket.send(r),this.hide()},t.prototype.sendFace=function(){this.hide()},t.prototype.setFaceUserfulData=function(){this.chatImgBg.visible=!0,this.txtGroup.visible=!1,this.faceGroup.visible=!0;for(var e=new Array,t=1;21>t;t++){var n="chatFace"+t+"_png";e.push(n)}this.faceList.itemRenderer=FaceItem,this.faceList.dataProvider=new eui.ArrayCollection(e),this.faceScroller.viewport=this.faceList},t}(BasePanel);__reflect(ChatPanel.prototype,"ChatPanel");var FaceItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="FaceItemSkin",t}return __extends(t,e),t}(eui.ItemRenderer);__reflect(FaceItem.prototype,"FaceItem");var UsefuleItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="UsefuleItemSkin",t}return __extends(t,e),t.prototype.dataChanged=function(){},t}(eui.ItemRenderer);__reflect(UsefuleItem.prototype,"UsefuleItem");var DKGameController=function(e){function t(){var t=e.call(this)||this;return t.gamePlaying=!1,t.isChangeSeat=!1,t.addEvent(eui.UIEvent.CREATION_COMPLETE,t.init,t),t}return __extends(t,e),t.prototype.init=function(){},t.prototype.onRegister=function(){this.addEvent(t.EVENT_SHOW_GAME_SCENE,this.showGameScene,this)},t.prototype.onRemove=function(){this.removeEvent(t.EVENT_SHOW_GAME_SCENE,this.showGameScene,this)},t.prototype.showGameScene=function(){this.registerSocket(),this.gameScene=App.SceneManager.runScene(SceneConst.DKGameScene,this),this.gameScene.hasEventListener("CHNAGEPLAYERHEAD")||this.gameScene.addEventListener("CHNAGEPLAYERHEAD",this.directChangeHead,this),this.gameId=App.DataCenter.UserInfo.httpUserInfo.serverId,this.gamePlaying=!1;for(var e in GameData.allPlayerInfo)parseInt(egret.getOption("roleId"))==GameData.allPlayerInfo[e].player.roleId&&this.gameScene.resetAll();this.updateUsersInfo(),this.gameScene.initRoom(),this.gameScene.replaceCRoom(GameData.endTime),console.log("房间是否是准备阶段:",GameData.roomstats),console.log("房间是否是准备阶段:",GameData.allPlayerInfo);var t=0,n=0;for(var e in GameData.allPlayerInfo)t++,App.DataCenter.UserInfo.httpUserInfo.seat==GameData.allPlayerInfo[e].seat&&1==GameData.allPlayerInfo[e].ready?(this.gameScene.showOkOrCancel(!1),this.gameScene.startGame=!0):App.DataCenter.UserInfo.httpUserInfo.seat==GameData.allPlayerInfo[e].seat&&0==GameData.allPlayerInfo[e].ready&&1==GameData.roomstats&&(this.gameScene.showOkOrCancel(!0),this.gameScene.startGame=!0),parseInt(egret.getOption("roleId"))==GameData.allPlayerInfo[e].player.roleId&&(this.gameScene.okBtn.visible=!0,this.gameScene.shareBtn.visible=!1,GameData.isWatcher=!1,n++);
if(n>0?this.gameScene.chatBtn.visible=!0:(GameData.isWatcher=!0,this.gameScene.okBtn.visible=!1),console.log("GameData.hnad:",GameData.hnad),console.log("GameData.iswinOrder:",GameData.iswinOrder),console.log("GameData.roomstats:",GameData.roomstats),1==GameData.roomstats&&(this.gameScene.startGame=!1),void 0!=GameData.hnad&&void 0!=GameData.roomstats&&void 0!=GameData.iswinOrder)(GameData.hnad.length>0||GameData.iswinOrder>0&&2==GameData.roomstats)&&this.revCardsduanxian(GameData.hnad);else if(1==GameData.isWatcher&&void 0!=GameData.allPlayerInfo[1]&&2==GameData.roomstats){App.DataCenter.UserInfo.httpUserInfo.seat=0;for(var o=[],r=0;r<GameData.allPlayerInfo[1].handSize;r++)o.push({type:0,value:61});this.revCardsduanxian(o)}},t.prototype.registerSocket=function(){var e=App.gameSocket;e.register(132001,this.revPlayerEnter,this),e.register(132002,this.revPlayerReady,this),e.register(131003,this.myReadyInfo,this),e.register(131004,this.playCard,this),e.register(132005,this.revOutPutTip,this),e.register(131006,this.exitRoom,this),e.register(132009,this.revExitRoom,this),e.register(131007,this.dissRoom,this),e.register(132011,this.revDisRoom,this),e.register(132015,this.RecoverClear,this),e.register(132020,this.DisRoom,this),e.register(132010,this.revAppDisRoom,this),e.register(132003,this.revCards,this),e.register(132033,this.revTs,this),e.register(132004,this.revChangePos,this),e.register(132007,this.revOutPutShow,this),e.register(132008,this.revSingleScore,this),e.register(132014,this.revResultinfo,this),e.register(131009,this.revChat,this),e.register(132013,this.revReNewData,this),e.register(131002,this.revReNewDataReally,this),e.register(132018,this.revPlayju,this),e.register(132021,this.revTeammate,this),e.register(132023,this.revRanking,this),e.register(131010,this.myAlreadyseat,this),e.register(133001,this.otherAlreadyseat,this),e.register(132016,this.otherseatup,this),e.register(131014,this.watchList,this),e.register(131017,this.fightList,this)},t.prototype.fightList=function(e){var t=this;this.gameScene.fight_id.visible=!0,this.gameScene.fight_id.figGroup.visible=!0,0==this.gameScene.fight_id.hideReck.visible&&egret.Tween.get(this.gameScene.fight_id.figGroup).to({x:-567}).to({x:0},400).call(function(){egret.Tween.removeTweens(t.gameScene.fight_id.figGroup),t.gameScene.fight_id.hideReck.visible=!0}),this.gameScene.fight_id.sendData(e.list)},t.prototype.watchList=function(e){var t=this;this.gameScene.watch_Id.visible=!0,this.gameScene.watch_Id.scollGrop.visible=!0,egret.Tween.get(this.gameScene.watch_Id.scollGrop).to({x:-567}).to({x:0},400).call(function(){egret.Tween.removeTweens(t.gameScene.watch_Id.scollGrop),t.gameScene.watch_Id.hideReck.visible=!0}),this.gameScene.watch_Id.sendData(e.list)},t.prototype.otherseatup=function(e){this.gameScene.resetAll(),this.gameScene.shareBtn.visible=!0;var t=this.changeSeat(e.seat);this.gameScene.setReadyFlag(t,!1);for(var n in App.DataCenter.UserInfo.httpUserInfo.seatMap)App.DataCenter.UserInfo.httpUserInfo.seatMap[n].seat==e.seat&&delete App.DataCenter.UserInfo.httpUserInfo.seatMap[n];0!=App.DataCenter.UserInfo.httpUserInfo.seat||this.gameScene.setupresetAll(),this.gameScene.setRoomInfo()},t.prototype.otherAlreadyseat=function(e){App.DataCenter.UserInfo.httpUserInfo.seatMap[e.seatInfo.seat]=e.seatInfo,this.revPlayerEnter(e)},t.prototype.myAlreadyseat=function(e){if(this.gameScene.okBtn.visible=!0,GameData.isWatcher=!1,void 0!=e.seatMap){this.gameScene.chatBtn.visible=!0,this.gameScene.okBtn.visible=!0,this.gameScene.readyGroup.visible=!0,this.gameScene.shareBtn.visible=!1;var t=e.seatMap;for(var n in t)t[n].player.roleId==e.identify&&(App.DataCenter.UserInfo.httpUserInfo.seat=t[n].seat);App.DataCenter.UserInfo.httpUserInfo.seatMap=e.seatMap,this.gameScene.resetAll(),this.gameScene.setRoomInfo()}else{this.gameScene.shareBtn.visible=!0,this.gameScene.okBtn.visible=!1,this.gameScene.cancelBtn.visible=!1,GameData.isWatcher=!0,App.DataCenter.UserInfo.httpUserInfo.seat=0,this.gameScene.setReadyFlag(0,!1);for(var n in App.DataCenter.UserInfo.httpUserInfo.seatMap)App.DataCenter.UserInfo.httpUserInfo.seatMap[n].player.roleId==e.identify&&delete App.DataCenter.UserInfo.httpUserInfo.seatMap[n];this.gameScene.setupresetAll(),console.log("App.DataCenter.UserInfo.httpUserInfo.seatMap:",App.DataCenter.UserInfo.httpUserInfo.seatMap),this.gameScene.setRoomInfo()}},t.prototype.revRanking=function(e){var t=e.orderMap;this.gameScene.clearRankingGroup();for(var n in t)if(t[n]>0){var o=this.changeSeat(parseInt(n));this.gameScene.howRankingGroupFun(o,t[n])}},t.prototype.revTeammate=function(e){this.AllData={},GameData.isplayerCardSeat=!1,this.isChangeSeat=!1,e.bankRole>0&&void 0!=e.orderPoker&&0!=e.orderPoker.value&&(this.isChangeSeat=!0,this.AllData=e,GameData.isplayerCardSeat=!0)},t.prototype.revPlayju=function(e){GameData.yida=e.round,this.gameScene.gameTime_txt.text="局数:"+GameData.yida+"/"+GameData.jiju},t.prototype.RecoverClear=function(){if(this.gameScene.showCardGroup.visible=!1,GameData.isWatcher)for(var e=1;5>e;e++){var t=this.changeSeat(e);this.gameScene.hidePassFlag(t),this.gameScene.cleanOutCard(t)}else for(var e=0;4>e;e++){var t=this.changeSeat(e);this.gameScene.hidePassFlag(t),this.gameScene.cleanOutCard(t)}},t.prototype.revDisRoom=function(e){this.gameScene.upApplyDisRoom(e.dissolveMap,e.seat)},t.prototype.revVoice=function(e){window.parent.postMessage({forLobby:!0,cmd:"wx",func:"downloadVoice",serverId:e},"*")},t.prototype.DisRoom=function(e){e.dissolve?this.revSuccessDisRoom():this.disRoomFail()},t.prototype.dissRoom=function(e){var t=e.errorCode;0==t||this.revMyQuitGame(e)},t.prototype.exitRoom=function(e){var t=e.errorCode;(0==t||void 0==t)&&this.revQuitGame(e)},t.prototype.revExitRoom=function(e){this.revQuitGame(e)},t.prototype.playCard=function(e){var t=e.errorCode,n=e.identify,o=e.segment;if(void 0!=o)var r=o.type;var a=App.DataCenter.UserInfo.httpUserInfo.roleId;if(a==n)if(0==t)if(this.gameScene.stopTimer(),0!=r){var i=o.member[0].value;this.playCardSound(i,r),this.revOutPutSuccess(e),this.gameScene.showActUI(!1)}else{this.playCardSound(0,r),this.gameScene.showActUI(!1);var s=this.changeSeat(App.DataCenter.UserInfo.httpUserInfo.seat);this.gameScene.showPassFlag(s)}else 1310041==t?(this.revOutPutErrLess(e),this.gameScene.toDownAllCard()):(this.revOutPutErr4Type(e),this.gameScene.toDownAllCard())},t.prototype.playCardSound=function(e,t){var n=this;"1"==t?RES.getResAsync("man_oneCard"+e+"_mp3",function(){App.SoundManager.playEffect("man_oneCard"+e+"_mp3")},this):"2"==t?RES.getResAsync("man_DB_"+e+"_mp3",function(){App.SoundManager.playEffect("man_DB_"+e+"_mp3")},this):"3"==t?(DragonBonesManager.getInstance().startDragon(this.gameScene.animationGroup,"effect1","effect1","effect1","effect1","effect1","Company",650,320,1),RES.getResAsync("man_liandui_mp3",function(){App.SoundManager.playEffect("man_liandui_mp3")},this)):"4"==t?RES.getResAsync("man_THREE_"+e+"_mp3",function(){App.SoundManager.playEffect("man_THREE_"+e+"_mp3")},this):"5"==t?(RES.getResAsync("doudizhu_tex_png",function(){DragonBonesManager.getInstance().startDragon(n.gameScene.animationGroup,"doudizhu","doudizhu","doudizhu","doudizhu","feiji","newAnimation",650,320,1)},this),RES.getResAsync("man_plane_mp3",function(){App.SoundManager.playEffect("man_plane_mp3")},this)):"6"==t?(RES.getResAsync("Company_tex_png",function(){DragonBonesManager.getInstance().startDragon(n.gameScene.animationGroup,"Company","Company","Company","Company","Company","Company",650,320,1)},this),RES.getResAsync("man_shunzi_mp3",function(){App.SoundManager.playEffect("man_shunzi_mp3")},this)):"7"==t?(61==e||62==e?RES.getResAsync("doudizhu_tex_png",function(){DragonBonesManager.getInstance().startDragon(n.gameScene.animationGroup,"doudizhu","doudizhu","doudizhu","doudizhu","wangzha","newAnimation",650,320,1)},this):RES.getResAsync("man_boom_mp3",function(){DragonBonesManager.getInstance().startDragon(n.gameScene.animationGroup,"bomo","bomo","bomo","bomo","bomo","bomo",650,320,1)},this),RES.getResAsync("man_boom_mp3",function(){egret.setTimeout(function(){App.SoundManager.playEffect("man_boom_mp3")},n,500)},this)):"0"==t&&RES.getResAsync("man_guo_mp3",function(){App.SoundManager.playEffect("man_guo_mp3")},this)},t.prototype.revQuitGame=function(e){var t=e.seat,n=App.DataCenter.UserInfo.httpUserInfo.seat;if(t==n||void 0==e.seat)window.parent.postMessage({forLobby:!0,cmd:"close"},"*");else{var o=this.changeSeat(t);this.gameScene.hideOtherHeadUi(o),this.gameScene.setIntegral("",o),this.gameScene.setReadyFlag(o,!1)}},t.prototype.revMyQuitGame=function(e){App.MsgBoxManager.recycleAllBox(),Tips.info("房间解散成功，已归还棒棒糖！！"),App.DataCenter.UserInfo.getMyUserVo().gold=e.msg[0].roomCard,App.MsgBoxManager.recycleAllBox(),App.getInstance().sendEvent(HallController.EVENT_SHOW_HALL),this.gameScene.reConnectedTimer.stop(),this.gameScene.initApplyDisTimer()},t.prototype.revAppDisRoom=function(e){var t=e.seat,n=App.DataCenter.UserInfo.httpUserInfo.seat;App.MsgBoxManager.recycleAllBox(),this.gameScene.initApplyDisRoom();var o=this.gameScene.applyDisRoom;t!=n?(o.thisObject=this,o.ok=this.sendAgreeDisRoom,o.cancel=this.sendUnAgreeDisRoom):(o.img_ing.visible=!0,o.group_btn.visible=!1),GameData.isWatcher&&(o.group_btn.visible=!1),this.gameScene.initApplyDisTimer(),this.gameScene.updateApplyDisRoom(t,30)},t.prototype.sendAgreeDisRoom=function(){var e=App.DataCenter.UserInfo.httpUserInfo.roleId,t={cmd:131008,roleId:e,agree:!0};App.gameSocket.send(t)},t.prototype.sendUnAgreeDisRoom=function(){var e=App.DataCenter.UserInfo.httpUserInfo.roleId,t={cmd:131008,roleId:e,agree:!1};App.gameSocket.send(t)},t.prototype.disRoomFail=function(){App.MsgBoxManager.recycleAllBox();var e=App.MsgBoxManager.getBoxA();e.showMsg("房间解散失败"),App.DataCenter.UserInfo.initPlayerApply(),this.gameScene.initApplyDisRoom(),this.gameScene.initApplyDisTimer()},t.prototype.revPlayerAgree=function(e){this.gameScene.updateApplyDisRoom(e,30),this.gameScene.applyDisRoom.touch()},t.prototype.revDissolveRoom=function(e,t){this.gameScene.upApplyDisRoom(e,t)},t.prototype.revSuccessDisRoom=function(){App.MsgBoxManager.recycleAllBox();var e=App.MsgBoxManager.getBoxA();e.showMsg("解散房间成功,返回大厅"),e.thisObject=this,this.gameScene.initApplyDisTimer(),e.ok=function(){window.parent.postMessage({forLobby:!0,cmd:"close"},"*")}},t.prototype.revChat=function(e){if(e.serverId){this.revVoice(e.serverId);var t=e.roleId;for(var n in GameData.allPlayerInfo)t==GameData.allPlayerInfo[n].player.roleId&&this.gameScene.showChat(GameData.allPlayerInfo[n].seat,0,3,"")}else{var o=e.seat,r=e.sex,a=e.flag,i=e.message,s=this.changeSeat(o);this.gameScene.showChat(s,r,a,i)}},t.prototype.revOkBack=function(e){App.DataCenter.UserInfo.httpUserInfo.gold=e.msg[0].roomCard,App.MsgBoxManager.recycleAllBox(),App.getInstance().sendEvent(HallController.EVENT_SHOW_HALL),this.gameScene.reConnectedTimer.stop()},t.prototype.revPlayerEnter=function(e){console.log("有玩家加入房间：",e);var t=new UserVO,n=e.seatInfo,o=n.player,r=(o.gold,o.headImgUrl),a=o.roleId,i=(o.sex,o.nickname),s=n.seat,p=n.score;n.pass,n.ready,n.desk,n.winOrder;t.roleId=a,t.nickName=i,t.seat=s,t.score=p,-1!=r.indexOf("http")?t.headImgUrl=r:t.headImgUrl="touxiang_png",App.DataCenter.UserInfo.addUser(t),GameData.peopleNum.indexOf(a)<0&&GameData.peopleNum.push(a),console.log(">>>>>>>:",App.DataCenter.UserInfo.userList),console.log(">>>>>>>:",GameData.peopleNum),GameData.peopleNum.length>3?this.gameScene.shareBtn.visible=!1:this.gameScene.shareBtn.visible=!0;var c=this.changeSeat(t.seat);this.gameScene.setHeadUI(c,t),this.gameScene.setIntegral(p,c)},t.prototype.revPlayerEnter1=function(e){console.log("有玩家加入房间：",e);var t=new UserVO,n=e.seatMap,o=n.player,r=o.headImgUrl,a=o.roleId,i=(o.sex,o.nickname),s=n.seat,p=n.score;n.pass,n.ready,n.winOrder;t.roleId=a,t.nickName=i,t.seat=s,-1!=r.indexOf("http")?t.headImgUrl=r:t.headImgUrl="touxiang_png",App.DataCenter.UserInfo.addUser(t),GameData.peopleNum.indexOf(a)<0&&GameData.peopleNum.push(a),console.log(">>>>>>>:",App.DataCenter.UserInfo.userList),console.log(">>>>>>>:",GameData.peopleNum),GameData.peopleNum.length>3;var c=this.changeSeat(t.seat);this.gameScene.setHeadUI(c,t),this.gameScene.setIntegral(p,c)},t.prototype.revPlayerReady=function(e){var t=e.seat,n=e.ready,o=App.DataCenter.UserInfo.httpUserInfo.seatMap;for(var r in o)r==t&&(o[r].ready=n);var a=this.changeSeat(t);this.gameScene.setReadyFlag(a,n);var i=App.DataCenter.UserInfo.httpUserInfo.seat;i==t&&this.gameScene.showOkOrCancel(n);App.DataCenter.UserInfo.httpUserInfo},t.prototype.revReNewData=function(e){var t=this.changeSeat(e.seat)+1;0==e.online?this.gameScene.showDisOnLine(t):1==e.online&&this.gameScene.hideDisOnLine(t)},t.prototype.revReNewDataReally=function(e){App.DataCenter.UserInfo.httpUserInfo.seat=e.room.playSeat,App.DataCenter.UserInfo.httpUserInfo.roomId=e.room.roomId,console.log("data[msg][score]:",e.msg.score),App.DataCenter.UserInfo.httpUserInfo.score=e.msg.score,App.DataCenter.UserInfo.httpUserInfo.owner=1==App.DataCenter.UserInfo.httpUserInfo.seat},t.prototype.revOwnerDisRoom=function(e){App.DataCenter.UserInfo.deleteAllUserExcptMe(),this.gameScene.initApplyDisRoom(),App.MsgBoxManager.recycleAllBox(),App.getInstance().sendEvent(HallController.EVENT_SHOW_HALL),this.gameScene.reConnectedTimer.stop(),App.gameSocket.send({cmd:102})},t.prototype.myReadyInfo=function(e){},t.prototype.revPlayCancelReady=function(e){var t=e.msg[0].index,n=this.changeSeat(t);this.gameScene.setReadyFlag(n,!1)},t.prototype.tsRevOutPutShow=function(e){var t=e.seat,n=(e.handSize,e.segment),o=n.type,r=n.member;if(0!=o&&this.tsData)for(var a=this.tsData.cheatList,i=0;i<a.length;i++)if(t==a[i].seat){for(var s=a[i].hand,p=0;p<r.length;p++)for(var c=0;c<s.length;c++)r[p].type!=s[c].type||r[p].value!=s[c].value||(console.log("出牌",r[p],s[c]),s.splice(c,1));this.gameScene.showAllHandleCard(s,a[i].roleId,this.changeSeat(parseInt(a[i].seat)))}},t.prototype.revTs=function(e){this.tsData=e;for(var t=0;t<e.cheatList.length;t++)this.gameScene.showAllHandleCard(e.cheatList[t].hand,e.cheatList[t].roleId,this.changeSeat(parseInt(e.cheatList[t].seat)))},t.prototype.revCards=function(e){if(this.gameScene.startGame=!0,GameData.isWatcher){this.gameScene.shareBtn.visible=!1,this.gameScene.stopTimers(),this.gamePlaying=!0,this.gameScene.setReadyGroup(!1);for(var t=[],n=0;27>n;n++)t.push({type:0,value:61});this.gameScene.showHandleCard(t),this.gameScene.showActUI(!1),this.gameScene.resetRemainCard(27),this.gameScene.chatBtn.visible=!1}else this.gameScene.shareBtn.visible=!1,this.gameScene.stopTimers(),console.log("开始手牌：",e.hand),this.gamePlaying=!0,this.gameScene.setReadyGroup(!1),this.gameScene.showHandleCard(e.hand),this.gameScene.showActUI(!1),this.gameScene.resetRemainCard(e.hand.length),this.gameScene.chatBtn.visible=!0},t.prototype.revCardsduanxian=function(e){if(App.ResUtils.loadGroup("sec_load",this,function(){},function(){}),console.log(">>>>>",GameData.isWatcher),1==GameData.isWatcher?this.gameScene.chatBtn.visible=!1:this.gameScene.chatBtn.visible=!0,this.gamePlaying=!0,this.gameScene.setReadyGroup(!1),console.log(">>>>>hnad:",e),0!=e.length){this.gameScene.startGame=!0,this.gameScene.shareBtn.visible=!1,this.gameScene.stopTimers(),this.gameScene.showHandleCard(e),this.gameScene.showActUI(!1),this.gameScene.resetRemainCard(e.length),console.log("GameData.playSeat:",GameData.playSeat),console.log("App.DataCenter.UserInfo.httpUserInfo.seat:",App.DataCenter.UserInfo.httpUserInfo.seat),GameData.playSeat==App.DataCenter.UserInfo.httpUserInfo.seat&&(0==GameData.isWatcher?this.gameScene.showActUI(!0):this.gameScene.showActUI(!1),console.log("GameData.hasGuoBtn:",GameData.hasGuoBtn),0==GameData.hasGuoBtn&&(this.gameScene.actOption.outBtn.x=80),this.gameScene.setActStatus(!GameData.hasGuoBtn));var t=GameData.tishiCardArr;for(var n in t)this.gameScene.cueCards.push(t[n].member)}console.log(".........",GameData.playSeat);var o=this.changeSeat(GameData.playSeat);if(console.log(o),this.gameScene.startTimer(o),0!=GameData.lastPlayerSeat)if(GameData.lastPlayerSeat==App.DataCenter.UserInfo.httpUserInfo.seat)void 0!=GameData.lastPlayCard&&this.gameScene.mySelfOutCardOK(GameData.lastPlayCard.member);else if(void 0!=GameData.lastPlayCard){var r=this.changeSeat(GameData.lastPlayerSeat);this.gameScene.otherOutCardShow(r,GameData.lastPlayCard.member,GameData.allPlayerInfo[GameData.lastPlayerSeat].handSize)}console.log(" GameData.allPlayerInfo:",GameData.allPlayerInfo);for(var a in GameData.allPlayerInfo){if(console.log(GameData.allPlayerInfo[a].seat+">>>>>>>>>>"+App.DataCenter.UserInfo.httpUserInfo.seat),GameData.allPlayerInfo[a].seat==App.DataCenter.UserInfo.httpUserInfo.seat);else{console.log(GameData.allPlayerInfo[a].seat+"-------"+GameData.allPlayerInfo[a].handSize);var r=this.changeSeat(GameData.allPlayerInfo[a].seat);this.gameScene.showRemainCard(r,GameData.allPlayerInfo[a].handSize)}if(GameData.allPlayerInfo[a].winOrder>0&&2==GameData.roomstats){var r=this.changeSeat(parseInt(GameData.allPlayerInfo[a].seat));this.gameScene.howRankingGroupFun(r,GameData.allPlayerInfo[a].winOrder),GameData.roomstats=2}}for(var a in GameData.offLinePlayer){var i=this.changeSeat(GameData.offLinePlayer[a])+1;this.gameScene.showDisOnLine(i)}this.revChangePos1(GameData.allPlayerInfo),console.log("GameData.isAgree.length::",GameData.isAgree);var s=0;for(var p in GameData.isAgree)s++;if(s>0){var c=App.DataCenter.UserInfo.httpUserInfo.seat;App.MsgBoxManager.recycleAllBox(),this.gameScene.initApplyDisRoom();var l=this.gameScene.applyDisRoom,h=!0;for(var n in GameData.isAgree)console.log("parseInt(j) != mySeatId:::",parseInt(n)),console.log("parseInt(j) != mySeatId:::",c),console.log("parseInt(j) != mySeatId:::",parseInt(n)!=c),parseInt(n)==c&&(h=!1);h?(l.thisObject=this,l.ok=this.sendAgreeDisRoom,l.cancel=this.sendUnAgreeDisRoom):(l.img_ing.visible=!0,l.group_btn.visible=!1),this.gameScene.initApplyDisTimer(),this.gameScene.updateApplyDisRoom(parseInt(n),parseInt(GameData.remainTime));for(var u in GameData.isAgree)this.gameScene.upApplyDisRoom(GameData.isAgree[u],u)}},t.prototype.revChangePos=function(e){var t=e.seatInfo;if(1==this.isChangeSeat){console.log("同家与随机牌",this.AllData),console.log("同家与随机牌",t);for(var n in t){if(this.AllData.bankRole==t[n].player.roleId){if(t[n].player.nickname.length>5)var o=t[n].player.nickname.substr(0,4);else var o=t[n].player.nickname;var r=t[n].seat}if(this.AllData.teamRole==t[n].player.roleId){if(t[n].player.nickname.length>5)var a=t[n].player.nickname.substr(0,4);else var a=t[n].player.nickname;var i=t[n].seat}}this.gameScene.showChangePlayer(o,a);var s=this.changeSeat(r),p=this.changeSeat(i);this.gameScene.suiJiCardShow(s,this.AllData.orderPoker),this.gameScene.suiJiCardShow(p,this.AllData.orderPoker)}var c=e.seat1,l=e.seat2;if(0!=c&&0!=l){var h=this.changeSeat(c),u=this.changeSeat(l);this.gameScene.changePlayerHead(h,u)}var g=App.DataCenter.UserInfo.httpUserInfo.roleId;for(var d in t)if(t[d].player.roleId===g){App.DataCenter.UserInfo.httpUserInfo.seat=parseInt(d);break}this.seatInfo=t,this.MyID=g,this.head=e.hand,App.DataCenter.UserInfo.httpUserInfo.user=t,App.DataCenter.UserInfo.httpUserInfo.seatMap=t,this.gameScene.startGame=!0},t.prototype.directChangeHead=function(){var e=this;console.log("sadadadasda:",this.seatInfo);for(var t in this.seatInfo){var n=this.seatInfo[t],o=n.player,r=n.score,a=n.seat,i=o.roleId,s=o.nickname,p=o.headImgUrl,c=this.changeSeat(a);console.log("><><<><><><><:"+a+"--"+c),this.gameScene.setIntegral(r,c);var l=this.gameScene["name_"+c],h=this.gameScene["head_"+c];s.length>5?l.text=s.substr(0,4):l.text=s,-1!=p.indexOf("http")||(p=""),h.loadImg(p),this.MyID==i&&(this.gameScene.setHeadUI(c,App.DataCenter.UserInfo.httpUserInfo),this.gameScene.showHandleCard(this.head))}GameData.isplayerCardSeat=!1,console.log("vvvvvvvvvv:",GameData.playerCardSeat),egret.setTimeout(function(){e.gameScene.startTimer(GameData.playerCardSeat)},this,1e3)},t.prototype.revChangePos1=function(e){var t=e,n=App.DataCenter.UserInfo.httpUserInfo.roleId;for(var o in t)if(t[o].player.roleId===n){App.DataCenter.UserInfo.httpUserInfo.seat=parseInt(o);break}for(var o in t){var r=t[o],a=r.player,i=r.score,s=r.seat,p=(a.roleId,a.nickname),c=a.headImgUrl,l=this.changeSeat(s);this.gameScene.setIntegral(i,l);var h=this.gameScene["name_"+l],u=this.gameScene["head_"+l];p.length>5?h.text=p.substr(0,4):h.text=p,u.loadImg(c)}App.DataCenter.UserInfo.httpUserInfo.user=t,App.DataCenter.UserInfo.httpUserInfo.seatMap=t,this.gameScene.startGame=!0},t.prototype.revCleanOutCard=function(e){for(var t=e.msg[0],n=0;n<t.length;n++){var o=t[n].index,r=this.changeSeat(o);this.gameScene.cleanOutCard(r)}},t.prototype.revChangeCard=function(e){var t={cmd:"58",game:0,msg:[{list:[],number:0,random:1}]};t=e;for(var n=0;2>n;n++){var o=void 0;o=1==t.msg[0].list.length?App.DataCenter.UserInfo.getUserBySeatID(t.msg[0].list[0]):App.DataCenter.UserInfo.getUserBySeatID(t.msg[0].list[n]),o.changeCard||(o.changeCard=[]),o.changeCard.push(t.msg[0].random)}},t.prototype.revOutPutTip=function(e){if(GameData.isWatcher){var t=this.changeSeat(e.playSeat);this.gameScene.stopTimer(),this.gameScene.startTimer(t)}else{var n=e.canPass;this.gameScene.cueCards=[];App.DataCenter.UserInfo.httpUserInfo.roleId,e.identify;if(void 0==n){var t=this.changeSeat(e.playSeat);GameData.playerCardSeat=t,GameData.isplayerCardSeat||(this.gameScene.stopTimer(),this.gameScene.startTimer(t))}if(e.tip){console.log("提示出牌====================="),console.log(e.tip),0==GameData.isWatcher?this.gameScene.showActUI(!0):this.gameScene.showActUI(!1);var o=e.tip;for(var r in o)this.gameScene.cueCards.push(o[r].member);var a=App.DataCenter.UserInfo.httpUserInfo.seat,i=this.changeSeat(a);GameData.playerCardSeat=i,GameData.isplayerCardSeat||(this.gameScene.stopTimer(),this.gameScene.startTimer(i)),n?(this.gameScene.actOption.outBtn.x=348,this.gameScene.setActStatus(!1)):(this.gameScene.setActStatus(!0),this.gameScene.actOption.outBtn.x=80),this.gameScene.cleanOutCard(i)}}},t.prototype.cueCardList=function(e,t){if(0==e.length){var n=[];return void this.sendActPass(n)}if(t.toDownAllCard(),e.length>1&&!e.iscueCard){e.iscueCard=!0;for(var o=0;o<e.length;o++){var r=e[o][0].value,a={1:14,2:15};e[o].index=a[r]||r}e.sort(function(e,t){return e.length>t.length?1:e.length<t.length?-1:e.index-t.index})}for(var i in e[0])for(var r=e[0][i].value,s=e[0][i].type,p=(t.selfCards.getChildAt(i),0);p<t.selfCards.numChildren;p++){var c=t.selfCards.getChildAt(p);if(c.cardsValue==r&&c.cardsType==s&&!c.bUp){c.y=-50,c.bUp=!0;break}}},t.prototype.revTimerStart=function(e){var t=e.msg[0].index,n=this.changeSeat(t);this.gameScene.startTimer(n),this.gameScene.hidePassFlag(n)},t.prototype.revOhterPass=function(e){var t=e.seat,n=this.changeSeat(t);this.gameScene.showActUI(!1),this.gameScene.showPassFlag(n)},t.prototype.revOutPutSuccess=function(e){var t=e.segment,n=t.member;this.RecoverClear(),this.gameScene.mySelfOutCardOK(n),this.gameScene.showHandleCard(e.hand)},t.prototype.revOutPutShow=function(e){this.tsRevOutPutShow(e);var t=e.seat,n=this.changeSeat(t),o=e.handSize,r=e.segment,a=r.type,i=r.member;if(GameData.isWatcher&&1==t){for(var s=[],p=0;o>p;p++)s.push({type:0,value:61});this.gameScene.showHandleCard(s)}0==a?(this.playCardSound(0,a),this.revOhterPass(e)):(this.playCardSound(i[0].value,a),this.RecoverClear(),this.gameScene.otherOutCardShow(n,i,o))},t.prototype.revOutPutErr4Type=function(e){Tips.info("出牌不符合牌型")},t.prototype.revOutPutErrLess=function(e){Tips.info("出牌不符合牌型")},t.prototype.revResidueCard=function(e){var t=this,n=e.msg[0];n.forEach(function(e){var n=t.changeSeat(e.index),o=e.cardNum;t.gameScene.showRemainCard(n,o)})},t.prototype.revSingerOver=function(e){var t=this;this.gameScene.stopTimer();var n=e.msg[0];console.log("单局结束："+n),n.forEach(function(e){var n=e.index;if(n!=App.DataCenter.UserInfo.httpUserInfo.seat){var o=t.changeSeat(n),r=e.cards;t.gameScene.otherOutCardShow(o,r,r.length)}}),this.gameScene.setRoomInfo(),egret.setTimeout(function(){t.sendGetSingleScore()},this,5e3),this.gameScene.resetReadyFlag(),this.gameScene.hideReadyCancleBtn(),this.gameScene.hideAllPassFlag()},t.prototype.revSendRoomCard=function(e){App.MsgBoxManager.getBoxB();Tips.info("恭喜你，获赠"+e.msg[0].roomCard+"支棒棒糖。")},t.prototype.revSingleScore=function(e){this.gameScene.stopTimer(),console.log("小结算"+e),App.PanelManager.open(PanelConst.DkSingResultUI,function(){},this,!1);var t=App.PanelManager.getPanel(PanelConst.DkSingResultUI);t.setData(e),this.gameScene.startGame=!1,this.gameScene.cleanDeskCard(),this.gameScene.resetReadyFlag(),this.gameScene.hideAllPlayerRank(),this.cleanSelfCard();for(var n in e.balance){1==e.balance[n].qType?t.totalName.text="平扣":2==e.balance[n].qType?t.totalName.text="单扣":3==e.balance[n].qType&&(t.totalName.text="双扣");var o=App.DataCenter.UserInfo.httpUserInfo.seatMap;for(var r in o)if(e.balance[n].roleId===o[r].player.roleId){var a=this.changeSeat(parseInt(r));o[r].score=parseInt(o[r].score)+parseInt(e.balance[n].score),this.gameScene.setIntegral(e.balance[n].score,a),a||(console.log("data[balance][i][score]:",e.balance[n].score),App.DataCenter.UserInfo.httpUserInfo.score=e.balance[n].score);break}}var i=App.DataCenter.UserInfo.httpUserInfo.seatMap;for(var s in i)i[s].ready=!1},t.prototype.cleanSelfCard=function(){this.gameScene.selfCards.removeChildren()},t.prototype.reConnected=function(e){this.gameScene.connectedComplete(e)},t.prototype.revDisconnection=function(e){var t=e.msg[0].index,n=this.changeSeat(t);this.gameScene.showDisOnLine(n),this.gameScene.setReadyFlag(n,!1)},t.prototype.revReConnection=function(e){var t=e.msg[0].index,n=(App.DataCenter.UserInfo.getUserBySeatID(t),this.changeSeat(t));n!=UserPosition.Down&&this.gameScene.hideDisOnLine(n)},t.prototype.revResultinfo=function(e){if(0==e.round){var t=App.MsgBoxManager.getBoxAD();t.showMsg("15分钟内未开始游戏，房间已经自动解散，请点击确定返回大厅！"),t.ok=function(){window.parent.postMessage({forLobby:!0,cmd:"close"},"*")}}else GameData.revResultinfo=e,GameData.isTolal=!0},t.prototype.revResult=function(){var e=GameData.revResultinfo,t=(e.identify,e.list);App.PanelManager.open(PanelConst.DkResultUI,null,null,!1);var n=App.PanelManager.getPanel(PanelConst.DkResultUI);n.setData(t),App.LayerManager.popLayer.addChild(n),this.gameScene.startGame=!0,App.MsgBoxManager.recycleAllBox()},t.prototype.sendLeftRoom=function(e){var t;t={cmd:131007,roomId:e},App.gameSocket.send(t)},t.prototype.sendownerDisRoom=function(e){if(App.DataCenter.UserInfo.httpUserInfo.owner){var t={cmd:131006,msg:[{roomId:e}]};App.gameSocket.send(t)}},t.prototype.sendOutPutCard=function(e){var t=App.DataCenter.UserInfo.httpUserInfo.roleId,n={cmd:131004,identify:t,list:e};App.gameSocket.send(n)},t.prototype.sendContinue=function(){this.gameScene.resAllthing(),1==GameData.isWatcher||(this.gameScene.resetReadyFlag(),this.gameScene.readyGroup.visible=!0,this.gameScene.okBtn.visible=!0,this.gameScene.cancelBtn.visible=!1)},t.prototype.sendGetSingleScore=function(){var e={cmd:"28",game:this.gameId};App.gameSocket.send(e)},t.prototype.sendGetResult=function(){var e={cmd:"40",game:this.gameId};App.gameSocket.send(e)},t.prototype.sendActPass=function(e){var t=App.DataCenter.UserInfo.httpUserInfo.roleId,n={cmd:131004,identify:t,list:e};App.gameSocket.send(n),console.log(n)},t.prototype.sendTimeOutPass=function(){var e={cmd:"23",game:this.gameId};App.gameSocket.send(e)},t.prototype.sendTimeOutOPCard=function(){var e={cmd:"24",game:this.gameId};App.gameSocket.send(e)},t.prototype.sendContinueGame=function(){},t.prototype.sendReConnectionData=function(){},t.prototype.sendReNewData=function(){var e={cmd:"36",game:this.gameId,msg:[{openId:" ",nickname:" ",headImgUrl:" "}]},t=App.DataCenter.UserInfo.httpUserInfo;e.msg[0].openId=t.openId,e.msg[0].nickname=t.nickName,e.msg[0].headImgUrl=t.headImgUrl,App.gameSocket.send(e)},t.prototype.sendNewData=function(){var e={cmd:"120",game:this.gameId,msg:[{openId:" "}]},t=App.DataCenter.UserInfo.httpUserInfo;e.msg[0].openId=t.openId,App.gameSocket.send(e)},t.prototype.changeSeat=function(e){var t,n=App.DataCenter.UserInfo.httpUserInfo.seat;return t=0==n?e-1:e==n?0:e>n?e-n:4-n+e},t.prototype.changeIndex=function(e,t){var n=App.DataCenter.UserInfo.getUserBySeatID(e.toString()),o=App.DataCenter.UserInfo.getUserBySeatID(t.toString()),r=(App.DataCenter.UserInfo.httpUserInfo.seat,n.seat);n.seat=o.seat,o.seat=r},t.prototype.updateUsersInfo=function(){for(var e in App.DataCenter.UserInfo.userList){var t=App.DataCenter.UserInfo.userList[e],n=this.changeSeat(t.seat);this.gameScene.setHeadUI(n,t),t.roleId==App.DataCenter.UserInfo.httpUserInfo.roleId?this.gameScene.setIntegral(t.score):this.gameScene.setOtherIntegral(n,t.score)}},t.prototype.updateChangeCard=function(){for(var e in App.DataCenter.UserInfo.userList){var t=App.DataCenter.UserInfo.userList[e],n=this.changeSeat(t.seat);t.changeCard.length&&(this.gameScene.updateChangeCard(n,t.changeCard),t.changeCard=[])}},t.prototype.cleanChangeCard=function(){for(var e in App.DataCenter.UserInfo.userList){var t=App.DataCenter.UserInfo.userList[e];this.changeSeat(t.seat);t.changeCard=[]}this.updateChangeCard()},t.NAME="DKGameController",t.EVENT_QUIT_GAME="EVENT_QUIT_GAME",t.EVENT_SEND_CHAT="EVENT_SEND_CHAT",t.EVENT_SEND_ACT_FACE="EVENT_SEND_ACT_FACE",t.EVENT_SHOW_GAME_SCENE="EVENT_SHOW_DKGAME_SCENE",t}(BaseController);__reflect(DKGameController.prototype,"DKGameController");var DKGameScene=function(e){function t(){var t=e.call(this)||this;return t.tempOutCards=[],t.cueCards=[],t.gameId=0,t.reConnectedTimer=new egret.Timer(2e3),t.reconnetCount=0,t.skinName="DKGameSceneSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){window.parent.postMessage({forLobby:!0,cmd:"ready"},"*")},t.prototype.onEnable=function(){},t.prototype.replaceCRoom=function(e){var t=this;if(0!=e){var n=Math.floor(e/6e4);console.log("MMMMMMMMMMM:",n);var o=(e%6e4+"").substr(0,2);console.log("timesssssss:",n+":"+o),this.time=new egret.Timer(1e3,Math.ceil(e/1e3)),this.time.addEventListener(egret.TimerEvent.TIMER,function(){parseInt(o)>0?(o=(parseInt(o)-1).toString(),parseInt(o)<10&&parseInt(o)>=0&&(o="0"+o)):(n-=1,o="59"),t.endTime.text=n+":"+o},this),this.time.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){t.time.stop()},this),this.time.start()}else this.endTimeGroup.visible=!1},t.prototype.stopTimers=function(){this.time&&this.time.stop(),this.endTimeGroup.visible=!1},t.prototype.initRoom=function(){var e=this;this.resetUI(),this.once(egret.TouchEvent.TOUCH_TAP,function(){App.SoundManager.playBGM("music_mp3")},this),this.togBtn_menu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTogBtnMenu,this),this.yingchang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTogBtnMenu1,this),this.backHallBtn.addEventListener("touchTap",this.onBackToHall,this),this.watchlistsBtn.addEventListener("touchTap",this.watchlistsFun,this),this.StandupBtn.addEventListener("touchTap",this.StandupFun,this),this.backHomeBtn.addEventListener("touchTap",this.backHomeFun,this),this.continueBtn.addEventListener("touchTap",this.onContinueBtn,this),this.okBtn.addEventListener("touchTap",this.onReadyTouch,this),this.cancelBtn.addEventListener("touchTap",this.onReadyTouch,this),this.actOption.addEventListener("touchTap",this.onActTouch,this),this.inviteHall_btn.addEventListener("touchTap",this.onInviteTouch,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setdown,this),this.setBtn.addEventListener("touchTap",this.onAppDisRoom,this),this.fightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fightBtnFun,this),this.topHallBtn.addEventListener("touchTap",this.openTopGame,this),this.reConnectedTimer.start(),this.chatBtn.addEventListener("touchTap",function(){RES.getResAsync("chatimgspr_png",function(){},e),App.PanelManager.open(PanelConst.ChatPanel)},this),this.voice_btn.addEventListener(egret.TouchEvent.TOUCH_END,this.endVoice,this),this.voice_btn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.endVoice,this),this.voice_btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.yuyinganimation=new RecordBox,e.yuyinganimation.horizontalCenter=0,e.yuyinganimation.verticalCenter=0,e.addChild(e.yuyinganimation),e.startVoice=Date.now(),window.parent.postMessage({forLobby:!0,cmd:"wx",func:"startRecord"},"*")
},this),this.ruleHallBtn.addEventListener("touchTap",this.openRuleRoom,this),this.selfCards.visible=!1,this.showCardGroup.visible=!1,this.resetOutCard(),this.cleanIntegral(),this.checkReCon(),this.setRoomInfo(),this.setHeadUI(0,App.DataCenter.UserInfo.httpUserInfo),this.applyDisRoom=new ApplyDisRoomView,this.applyDisRoom.touch(),this.addChild(this.applyDisRoom),this.applyDisRoom.horizontalCenter=0,this.applyDisRoom.verticalCenter=0,this.applyDisRoom.visible=!1,console.log("进入双扣游戏____________________________");var t="{platform}-双扣，房间号为"+this.gameRoomId_txt.text,n="模式：双扣 局数："+GameData.jiju+"局 扣费方式："+(GameData.isAA?"AA制":"房主付费");window.parent.postMessage({forLobby:!0,cmd:"wx",func:"initShare",title:t,desc:n},"*")},t.prototype.StandupFun=function(){this.group_menu.visible=!1,this.group_menu.scaleX=this.group_menu.scaleY=0;new DKGameController;if(1==this.startGame)if(GameData.isWatcher){var e=App.MsgBoxManager.getBoxA();e.showMsg("您就是观战者，不能站起")}else{var e=App.MsgBoxManager.getBoxA();e.showMsg("游戏已经开始,不能站起围观")}else{var t={cmd:"131010",seat:0};App.gameSocket.send(t)}},t.prototype.watchlistsFun=function(){this.group_menu.visible=!1,this.group_menu.scaleX=this.group_menu.scaleY=0;var e=(new DKGameController,{cmd:"131014"});App.gameSocket.send(e)},t.prototype.backHomeFun=function(){this.group_menu.visible=!1,this.group_menu.scaleX=this.group_menu.scaleY=0;var e=App.DataCenter.UserInfo.httpUserInfo.roomId,t=App.MsgBoxManager.getBoxOC();this.startGame?0==GameData.isWatcher?(t.showMsg("解散房间需要征求所有在线玩家同意，您确定要申请解散房间么？"),t.ok=function(){var t=new DKGameController;t.sendLeftRoom(e)}):(t.showMsg("您是观战者，不可以申请解散房间！"),t.ok=function(){}):(t.showMsg("游戏还未开始，不可以申请解散房间！"),t.ok=function(){})},t.prototype.fightBtnFun=function(e){var t={cmd:"131017",type:"0"};App.gameSocket.send(t)},t.prototype.initApplyDisRoom=function(){this.applyDisRoom.init(),this.applyDisRoom.visible=!1},t.prototype.endVoice=function(){return this.removeChild(this.yuyinganimation),Date.now()-this.startVoice>1500?void window.parent.postMessage({forLobby:!0,cmd:"wx",func:"stopRecord",type:1},"*"):void window.parent.postMessage({forLobby:!0,cmd:"wx",func:"stopRecord",type:0},"*")},t.prototype.updateApplyDisRoom=function(e,t){this.applyDisRoom.myFresh(e),this.applyDisRoom.startTime(t)},t.prototype.upApplyDisRoom=function(e,t){this.applyDisRoom.freshPlayer(e,t)},t.prototype.initApplyDisTimer=function(){this.applyDisRoom.initTimer()},t.prototype.onRemove=function(){App.DataCenter.UserInfo.initPlayerApply()},t.prototype.onInviteTouch=function(){this.group_menu.visible=!1;var e="{platform}-双扣，房间号为"+this.gameRoomId_txt.text,t="模式：双扣 局数："+GameData.jiju+"局 扣费方式："+(GameData.isAA?"AA制":"房主付费");window.parent.postMessage({forLobby:!0,cmd:"wx",func:"initShare",title:e,desc:t},"*"),this.invit=new Invitation,this.invit.onEnable(),this.addChild(this.invit)},t.prototype.setdown=function(){console.log("setdown",-1),App.ResUtils.loadGroup("sec_load",this,function(){},function(){});var e={cmd:"131010",seat:"-1"};App.gameSocket.send(e)},t.prototype.onShare=function(){this.shareImg.visible=!1,this.shareImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this)},t.prototype.openRuleRoom=function(){this.group_menu.visible=!1,this.rule=new RuleRoom,this.rule.onEnable(),this.addChild(this.rule)},t.prototype.openTopGame=function(){this.group_menu.visible=!1;var e=new topGame;e.onEnable(),e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},t.prototype.onAppDisRoom=function(){App.PanelManager.open(PanelConst.SetPanel)},t.prototype.checkReCon=function(){App.DataCenter.GameInfo.isReCon&&this.GameController.sendReNewData()},t.prototype.resetUI=function(){this.showActUI(!1),this.setBack2HallBtn(!0),this.setReadyGroup(!0),this.resetReadyFlag(),this.hideHeadUI(),this.cleanDeskCard(),this.resetOutCard(),this.showOkOrCancel(!0),this.stopTimer(),this.hideAllPassFlag(),this.hideAllPlayerRank(),this.ready_txt.visible=!1,this.group_menu.visible=!1,this.selfCards.visible=!1,this.startGame=!1},t.prototype.resetOutCard=function(){for(var e=0;4>e;e++)this.cleanOutCard(e)},t.prototype.showChangePlayer=function(e,t){var n=this;this.changePlayerGroup.visible=!0;var o=this.changePlayerGroup.getChildAt(1),r=this.changePlayerGroup.getChildAt(2);o.text=e,r.text=t,egret.Tween.removeTweens(this.changePlayerGroup),egret.Tween.get(this.changePlayerGroup).wait(4e3).call(function(){n.changePlayerGroup.visible=!1})},t.prototype.showPlayRank=function(e,t){var n=this.playerGroup.getChildAt(e),o=n.getChildAt(0);o.showRank(t)},t.prototype.hideAllPlayerRank=function(){for(var e=0;4>e;e++){var t=this["head_"+e];t.hideRank(),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.howSeat,this)}},t.prototype.howSeat=function(e){if(console.log("head: HeadUI:》》",e.target.parent.head_shareBtn.visible),console.log("head: HeadUI:》》",e.target.parent.setDownBtn.visible),e.target.parent.head_shareBtn.visible)this.onInviteTouch();else if(GameData.isWatcher){App.ResUtils.loadGroup("sec_load",this,function(){},function(){}),console.log("head: HeadUI:》》》》!",e.target.parent.name);var t={cmd:"131010",seat:e.target.parent.name};App.gameSocket.send(t)}else;},t.prototype.cleanHeadUI=function(){for(var e=0;4>e;e++){var t=this.playerGroup.getChildAt(e),n=t.getChildAt(0);n.scoreLabel.text="",n.hideDisOnLine()}},t.prototype.resetAll=function(){for(var e=0;4>e;e++){var t=this["name_"+e],n=this["head_"+e],o=this["score_"+e];o.text="",t.text="",n.loadImg(""),n.head_shareBtn.visible=!0,n.hideDisOnLine()}},t.prototype.setupresetAll=function(){for(var e=0;4>e;e++){var t=this["name_"+e],n=this["head_"+e],o=this["score_"+e];o.text="",t.text="",n.loadImg(""),n.setupBtn(),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.howSeat,this),n.hideDisOnLine()}},t.prototype.setRoomInfo=function(){var e=App.DataCenter.UserInfo.httpUserInfo.seatMap;console.log("seatMapseatMapseatMap:",e);for(var t=1;4>=t;t++)if(e[t]){var n=e[t],o=n.player,r=n.pass,a=n.ready,i=n.score,s=n.seat,p=(n.winOrder,o.headImgUrl),c=o.nickname,l=(o.roleId,o.roomId,o.sex,new DKGameController),h=l.changeSeat(s),u=this["name_"+h],g=this["head_"+h],d=this["score_"+h];void 0!=c?c.length>5?u.text=c.substr(0,4):u.text=c:u.text="",void 0!=p&&g.loadImg(p),d.text=i,a&&this.setReadyFlag(h,a),this.passGroup.getChildAt(h).visible=r}var m=App.DataCenter.UserInfo.httpUserInfo.roomInfo,f=App.DataCenter.UserInfo.httpUserInfo.roomId;App.DataCenter.UserInfo.httpUserInfo.time;this.gameTime_txt.text="局数:"+GameData.yida+"/"+GameData.jiju,0==m&&(this.gameMode_txt.text="经典双扣"),f&&(this.gameRoomId_txt.text=f.toString())},t.prototype.startTimer=function(e){console.log("startTimer:",e);for(var t=0;t<this.timerGroup.numChildren;t++){var n=this.timerGroup.getChildAt(t);e==t?(n.startTime(),n.visible=!0):(n.stopTime(),n.visible=!1)}},t.prototype.stopTimer=function(){for(var e=0;e<this.timerGroup.numChildren;e++){var t=this.timerGroup.getChildAt(e);t.stopTime(),t.visible=!1}},t.prototype.setIntegral=function(e,t){void 0===t&&(t=0),console.log("integral:",e),console.log("pos:",t),""==e&&(e=0),this["score_"+t].text=e.toString(),console.log("this:",this["score_"+t]),console.log("this:",this["score_"+t].text)},t.prototype.cleanDeskCard=function(){for(var e=0;e<this.showCardGroup.numChildren;e++){var t=this.showCardGroup.getChildAt(e);t.removeChildren()}},t.prototype.howRankingGroupFun=function(e,t){var n=this.howRankingGroup.getChildAt(e);if(n.visible=!0,n.source=t+"Rank_png",0!=e){var o=this.remainGroup.getChildAt(e-1);o.visible=!1}},t.prototype.clearRankingGroup=function(){for(var e=0;4>e;e++){var t=this.howRankingGroup.getChildAt(e);t.visible=!1,t.source=""}},t.prototype.setHeadUI=function(e,t){console.log("user:",t);var n=this["name_"+e],o=new DKGameController,r=(App.DataCenter.UserInfo.httpUserInfo.seat,o.changeSeat(e),t.score);if(void 0==t.nickName)if(void 0==t.seatMap)n.text="";else{var a="",i=t.seatMap;for(var s in i)i[s].player.roleId==parseInt(egret.getOption("roleId"))&&(a=i[s].player.nickname);a.length>5?n.text=a.substr(0,4):n.text=a}else t.nickName.length>5?n.text=t.nickName.substr(0,4):n.text=t.nickName;var p=this["head_"+e];void 0!=t.headImgUrl&&(p.loadImg(t.headImgUrl),p.head_shareBtn.visible=!1),console.log("scorescore:",t),console.log("scorescore:",t.score),this.setIntegral(r,e)},t.prototype.showChat=function(e,t,n,o){var r=this.chatGroup.getChildAt(e);r.showMsg(e,t,n,o)},t.prototype.showPassFlag=function(e){this.passGroup.getChildAt(e).visible=!0},t.prototype.hidePassFlag=function(e){this.passGroup.getChildAt(e).visible=!1},t.prototype.hideAllPassFlag=function(){for(var e=0;4>e;e++)this.hidePassFlag(e)},t.prototype.hideHeadUI=function(){for(var e=0;4>e;e++){var t=this["name_"+e],n=this["head_"+e];t.text="",n.hideDisOnLine()}},t.prototype.hideOtherHeadUi=function(e){var t=this["name_"+e],n=this["head_"+e];t.text="",0==App.DataCenter.UserInfo.httpUserInfo.seat?(n.loadImg(""),n.setupBtn(),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.howSeat,this)):n.loadImg("touxiangkuang_png_png"),n.hideDisOnLine()},t.prototype.changePlayerHead=function(e,t){var n=this;0==e?3==t?(e=2,t=1):1==t&&(e=2,t=3):0==t&&(3==e?(e=2,t=1):1==e&&(e=2,t=3)),console.log("seat1::",e),console.log("seat2::",t);var o=this.playerGroup.getChildAt(e),r=o.x,a=o.y;console.log("oneX::",r),console.log("oneY::",a);var i=this.playerGroup.getChildAt(t),s=i.x,p=i.y;console.log("twoX::",s),console.log("twoY::",p);var c=egret.Tween.get(o);c.to({x:s,y:p},3e3).call(function(){o.x=r,o.y=a});var c=egret.Tween.get(i);c.to({x:r,y:a},3e3).call(function(){console.log("headUi1.x::",o.x),console.log("headUi1.y::",o.y),console.log("headUi2.x::",i.x),console.log("headUi2.y::",i.y),i.x=s,i.y=p,console.log("headUi1.x::",o.x),console.log("headUi1.y::",o.y),console.log("headUi2.x::",i.x),console.log("headUi2.y::",i.y),n.dispatchEventWith("CHNAGEPLAYERHEAD")})},t.prototype.showDisOnLine=function(e){var t=this.playerGroup.getChildAt(e-1),n=t.getChildAt(1);n.showDisOnLine()},t.prototype.hideDisOnLine=function(e){var t=this.playerGroup.getChildAt(e-1),n=t.getChildAt(1);n.hideDisOnLine()},t.prototype.updateChangeCard=function(e,t){},t.prototype.fadeChangeCard=function(e){egret.Tween.removeTweens(e),egret.Tween.get(e).wait(2e3).to({alpha:.5},1500).call(function(){e.removeChildren(),e.alpha=1})},t.prototype.setContinueBtn=function(e){this.continueBtn.visible=e},t.prototype.onContinueBtn=function(){this.GameController.sendContinue()},t.prototype.setReadyFlag=function(e,t){console.log("pospospos:",e),console.log("readyreadyready:",t);var n=this["ready_"+e];n.visible=t,t&&!this.readyGroup.visible&&(this.readyGroup.visible=t)},t.prototype.resetReadyFlag=function(){for(var e=0;4>e;e++)this.setReadyFlag(e,!1)},t.prototype.setReadyGroup=function(e){this.readyGroup.visible=e},t.prototype.showActUI=function(e){this.actOption.visible=e},t.prototype.showEffect=function(){MovieClipUtils.getInstance().setResouce(this,"Bomb","bomo_json","bomo_png",1)},t.prototype.showPlane=function(){function e(){o.image.visible=!1,o.image.x=800,egret.Tween.removeTweens(o.image)}this.image.visible=!0;var t=egret.Tween.get(this.image),n=-400,o=this;t.to({x:n},2e3).call(e)},t.prototype.onComplete=function(){this.image.visible=!1,this.image.x=800,egret.Tween.removeTweens(this.image)},t.prototype.isMouseDownChangeTrue=function(){for(var e=0;e<this.selfCards.numChildren;e++){var t=this.selfCards.getChildAt(e);t.isMouseDown=!0}},t.prototype.toDownAllCard=function(){for(var e=0;e<this.selfCards.numChildren;e++){var t=this.selfCards.getChildAt(e);t.y=0,t.bUp=!1}},t.prototype.cleanOutCard=function(e){var t=this.showCardGroup.getChildAt(e);t.removeChildren()},t.prototype.showOkOrCancel=function(e){this.readyGroup.visible=!0,this.okBtn.visible=e,this.cancelBtn.visible=!e},t.prototype.showRemainCard=function(e,t){if(console.log("pos>>>>>>",e),0!=e){var n=this.remainGroup.getChildAt(e-1);n.setRemainCard(t)}},t.prototype.resetRemainCard=function(e){void 0===e&&(e=0);for(var t=0;4>t;t++)this.showRemainCard(t,e);this.remainGroup.visible=!0;for(var n=0;3>n;n++){var o=this.remainGroup.getChildAt(n);o.visible=!0}},t.prototype.resAllthing=function(){this.remainGroup.visible=!1,this.clearRankingGroup()},t.prototype.setOtherIntegral=function(e,t){if(e!=UserPosition.Down){var n=this.playerGroup.getChildAt(e),o=n.getChildAt(3);o.text=t.toString()}},t.prototype.cleanIntegral=function(){for(var e=1;4>e;e++){var t=(this.playerGroup.getChildAt(e),this["score_"+e]);t.text=""}},t.prototype.mySelfOutCardOK=function(e){App.DataCenter.UserInfo.httpUserInfo.seat;this.showCardGroup.visible=!0,this.OutCardGroup_0.visible=!0,this.OutCardGroup_0.removeChildren();for(var t=0;t<e.length;t++){var n=e[t],o=new CardData;o.x=30*t,o.setHandSkin(n,1),o.touchEnabled=!1,this.onRemoveCardListen(o),this.OutCardGroup_0.addChild(o)}},t.prototype.otherOutCardShow=function(e,t,n){this.showRemainCard(e,n);var o=this["OutCardGroup_"+e];o.visible=!0,this.showCardGroup.visible=!0,o.removeChildren();for(var r=0;r<t.length;r++){var a=t[r],i=new CardData;i.x=30*r,i.touchEnabled=!1,this.onRemoveCardListen(i),i.setHandSkin(a,1),o.addChild(i)}},t.prototype.suiJiCardShow=function(e,t){console.log("显示随机牌:",e),console.log("显示随机牌:",t);var n=this["suiJiPaiGroup_"+e];n.visible=!0,this.suiJiPaiGroup.visible=!0,n.removeChildren();var t=t,o=new CardData;o.x=30,o.touchEnabled=!1,o.scaleX=.6,o.scaleY=.6,o.setHandSkin(t,1),n.addChild(o),egret.setTimeout(function(){n.visible=!1},this,1500)},t.prototype.setActStatus=function(e){console.log("public setActStatus"),this.actOption.passBtn.visible=!e,this.actOption.tipBtn.visible=!e,this.actOption.outBtn.visible=!0},t.prototype.setActionStatus=function(e){this.actOption.outBtn.visible=e,this.actOption.tipBtn.visible=e},t.prototype.setBack2HallBtn=function(e){this.backHallBtn.visible=e},t.prototype.onBackToHall=function(){this.group_menu.visible=!1,this.group_menu.scaleX=this.group_menu.scaleY=0;var e=(App.DataCenter.UserInfo.httpUserInfo.roomId,App.MsgBoxManager.getBoxOC());this.startGame?GameData.isWatcher?(e.showMsg("您是观战者，您确定要退出房间吗?"),e.ok=function(){var e={cmd:"131006"};App.gameSocket.send(e)}):(e.showMsg("现在已经开始游戏，不可以中途退出房间！"),e.ok=function(){}):(e.showMsg("游戏还未开始，您确定要退出房间吗"),e.ok=function(){var e={cmd:"131006"};App.gameSocket.send(e)})},t.prototype.onTogBtnMenu=function(){0==this.group_menu.visible?(this.group_menu.visible=!0,this.group_menu.scaleX=this.group_menu.scaleY=1,console.log("this.startGamethis.startGame:",this.startGame)):this.group_menu.visible=!1},t.prototype.onTogBtnMenu1=function(){this.group_menu.visible=!1},t.prototype.onReadyTouch=function(e){switch(this.initTs(),e.target){case this.okBtn:this.showOkOrCancel(!1),this.setReadyFlag(0,!0),this.sendReady();break;case this.cancelBtn:this.sendCancelReady(),this.setReadyFlag(0,!1),this.showOkOrCancel(!0)}},t.prototype.sendReady=function(){var e=App.DataCenter.UserInfo.httpUserInfo.roleId,t={cmd:"131003",roleId:e,ready:!0};App.gameSocket.send(t)},t.prototype.sendCancelReady=function(){var e=App.DataCenter.UserInfo.httpUserInfo.roleId,t={cmd:"131003",roleId:e,ready:!1};App.gameSocket.send(t)},t.prototype.onActTouch=function(e){switch(e.target){case this.actOption.passBtn:var t=new DKGameController,n=[];t.sendActPass(n),this.toDownAllCard();break;case this.actOption.outBtn:this.sendOutPutCard(),this.toDownAllCard();break;case this.actOption.tipBtn:var t=new DKGameController;t.cueCardList(this.cueCards,this)}},t.prototype.initTs=function(){this.TsCardGroup_1.visible=!1,this.TsCardGroup_2.visible=!1,this.TsCardGroup_3.visible=!1},t.prototype.showAllHandleCard=function(e,t,n){if(console.log("透视",e,t,n),t==App.DataCenter.UserInfo.httpUserInfo.roleId)return void console.log("zj");var o=this["TsCardGroup_"+n];o.removeChildren(),o.visible=!0;for(var r=0,a=0,i=0;i<e.length;i++){var s=e[i],p=new CardTs;console.log(p),p.setHandSkin(s),1==n||3==n?a+=37:r+=50,p.x=r,p.y=a,o.addChild(p)}},t.prototype.showHandleCard=function(e){console.log(">>>>cards:",e),this.selfCards.removeChildren(),this.selfCards.visible=!0;var t=0;e.length>25?t=0:e.length<=25&&e.length>23?t=1:e.length<=23&&e.length>21?t=3:e.length<=21&&e.length>19?t=4:e.length<=19&&e.length>17?t=5:e.length<=17&&e.length>15?t=6:e.length<=15&&e.length>13?t=7:e.length<=13&&e.length>11?t=8:e.length<=11&&e.length>9?t=9:e.length<=9&&e.length>7?t=10:e.length<=7&&e.length>5?t=11:e.length<=5&&e.length>3?t=12:e.length<=3&&(t=13);for(var n=0;n<e.length;n++){var o=e[n],r=this["card_"+t];r.setHandSkin(o),r.y=0,r.touchEnabled=!0,this.onAddCardListen(r),this.selfCards.addChild(r),t++}},t.prototype.onAddCardListen=function(e){e.addEventListener("touchTap",this.touchBegin,e)},t.prototype.onRemoveCardListen=function(e){e.removeEventListener("touchTap",this.touchBegin,e)},t.prototype.hideReadyCancleBtn=function(){this.okBtn.visible=this.cancelBtn.visible=!1},t.prototype.touchBegin=function(e){App.SoundManager.playEffect("dapaiba_mp3"),0==this.y?(this.y=-50,this.bUp=!0):(this.y=0,this.bUp=!1)},t.prototype.unSelect=function(){},t.prototype.touchEnd=function(e){this.endSelect=e.target,this.changeSelectCardStatus()},t.prototype.changeSelectCardStatus=function(){var e=this.handCardGroup.getChildIndex(this.beginSelect),t=this.handCardGroup.getChildIndex(this.endSelect);if(e>t){var n=e;e=t,t=n}for(var o=e;t>=o;o++){var r=this.handCardGroup.getChildAt(o);r.toChangeStatus()}},t.prototype.getSelectOutCard=function(){var e=this.selfCards.numChildren;this.tempOutCards=[];for(var t=0;e>t;t++){var n=this.selfCards.getChildAt(t),o={type:n.cardsType,value:n.cardsValue};0!=n.y&&this.tempOutCards.push(o)}},t.prototype.sendOutPutCard=function(){if(this.getSelectOutCard(),this.tempOutCards.length){var e=new DKGameController;e.sendOutPutCard(this.tempOutCards)}},t.prototype.reSortHandCard=function(){for(var e=this.selfCards.numChildren,t=0;e>t;t++){var n=this.selfCards.getChildAt(t);n.x=30*t,this.selfCards.addChild(n)}},t.prototype.connectedComplete=function(e){this.reconnetCount=0,console.log("data:"+e);var t=this.getChildByName("connectPanel");null!=t&&this.removeChild(t)},t}(BaseScene);__reflect(DKGameScene.prototype,"DKGameScene");var DkResultUI=function(e){function t(){var t=e.call(this)||this;return t.listData=[],t.listScore=[],t.skinName="DKResuleSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.continueBtn.addEventListener("touchTap",this.onContinueTouch,this),this.shareBtn.addEventListener("touchTap",this.onShare,this),this.setCenter(),this.gameScene=App.SceneManager.runScene(SceneConst.DKGameScene)},t.prototype.onContinueTouch=function(){this.hide(),window.parent.postMessage({forLobby:!0,cmd:"close"},"*")},t.prototype.onShare=function(){var e="{platform} 双扣，房间号为"+App.DataCenter.UserInfo.httpUserInfo.roomId,t="战绩：\r\n"+this.name_0.text+" :"+this.score_0.text+"   "+this.name_1.text+" :"+this.score_1.text+"\r\n"+this.name_2.text+" :"+this.score_2.text+"   "+this.name_3.text+" :"+this.score_3.text;window.parent.postMessage({forLobby:!0,cmd:"wx",func:"initShare",title:e,desc:t},"*");var n=new Share;n.onEnable(),n.horizontalCenter=0,n.verticalCenter=0,this.addChild(n)},t.prototype.setData=function(e){this.txt_roomID.text="房间："+App.DataCenter.UserInfo.httpUserInfo.roomId,this.txt_time.text="局数:"+GameData.jiju,this.shareDesc="",this.listData=[],this.listScore=[];for(var t=0;t<e.length;t++){var n=e[t],o=this.dataGroup.getChildAt(t),r=o.getChildAt(0);r.source=n.headImgUrl,r.mask=o.getChildAt(1);var a=n.score;this.listScore.push(a);var i=n.nickname,s=this["score_"+t],p=this["name_"+t];i.toString.length>5?p.text=i.substr(0,4):p.text=i,a>0?s.textColor=12708447:s.textColor=16738408,s.text=a}for(var c=0,l=this.listScore[0],h=0;h<this.listScore.length;h++)l<this.listScore[h]&&(l=this.listScore[h]),c+=this.listScore[h];for(var u=0;u<this.listScore.length;u++){var g=this["win_"+u];this.listScore[u]==l&&0!=c?(console.log(">>>>>>",this.listScore[u]),console.log(">>>>>>",l),g.visible=!0):g.visible=!1}},t}(BasePanel);__reflect(DkResultUI.prototype,"DkResultUI");var DkSingResultUI=function(e){function t(){var t=e.call(this)||this;return t.listData=[],t.bInit=!1,t.skinName="DKSingResuleSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.continueBtn.addEventListener("touchTap",this.onContinueTouch,this),this.setCenter()},t.prototype.onContinueTouch=function(){var e=App.getController(DKGameController.NAME);1==GameData.isTolal?e.revResult():e.sendContinue(),this.hide()},t.prototype.setData=function(e){var t=this,n=App.DataCenter.UserInfo.httpUserInfo.user,o=e.balance;e.identify;for(var r in o){var a=n[r],i=a.player,s=i.headImgUrl,p=new DKGameController,c=o[r],l=c.winScore,h=(c.roleId,c.win),u=c.nickname,g=this["headImgUrl_"+r],d=this["headmask_"+r],m=this["banker_"+r],f=this["name_"+r],v=this["txt_score_"+r],y=(this["bg_"+r],this["boom_"+r]),C=c.bombList;y.removeChildren();for(var _=0,S=0,I=0,A=0,E=0,b=0,D=0,T=0,U=0;U<C.length;U++)"4"==C[U]?_++:"5"==C[U]?S++:"6"==C[U]?I++:"7"==C[U]?A++:"8"==C[U]?E++:"9"==C[U]?b++:"10"==C[U]?D++:"11"==C[U]&&T++;if(S>0){var k=new eui.Label;k.text="五星炸弹x"+S,k.size=24,k.textColor=16767399,y.addChild(k)}if(I>0){var k=new eui.Label;k.text="六星炸弹x"+I,k.size=24,k.textColor=16767399,y.addChild(k)}if(A>0){var k=new eui.Label;k.text="七星炸弹x"+A,k.size=24,k.textColor=16767399,y.addChild(k)}if(E>0){var k=new eui.Label;k.text="八星炸弹x"+E,k.size=24,k.textColor=16767399,y.addChild(k)}if(b>0){var k=new eui.Label;k.text="九星炸弹x"+b,k.size=24,k.textColor=16767399,y.addChild(k)}if(D>0){var k=new eui.Label;k.text="十星炸弹x"+D,k.size=24,k.textColor=16767399,y.addChild(k)}if(T>0){var k=new eui.Label;k.text="十一星炸弹x"+T,k.size=20,k.textColor=16767399,y.addChild(k)}v.text=l,l>=0?(v.textColor=11067451,v.size=36,v.fontFamily="SimHei"):(v.textColor=16730698,v.size=36,v.fontFamily="SimHei");var L=new DKGameScene,P=p.changeSeat(Number(r));L.setOtherIntegral(P,c.score),-1!=s.indexOf("http")?g.source=s:g.source="touxiang_png",g.mask=d,u.length>5?f.text=u.substr(0,4):f.text=u,h?m.visible=!0:m.visible=!1}this.countDown(),1==GameData.isWatcher&&egret.setTimeout(function(){t.hide();var e=App.getController(DKGameController.NAME);e.sendContinue()},this,5e3)},t.prototype.countDown=function(){var e=new egret.Timer(15e3,0);e.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.hide,this)},t.prototype.timerFunc=function(){console.log("倒计时__")},t.prototype.sortData=function(e,t){for(var n=e.length,o=0;n>o;o++){e[o].banker}},t.prototype.calculateLabels=function(e){console.log(e);var t=new Array;if(null==e||e.length<=0)return t;for(var n=0;n<e.length;)0==e[n][1]?(console.log(e[n][1]),e.splice(n,1)):n++;if(console.log("cardTypeLength:"+e.length),1==e.length){var o=this.createLabel(e[0][0]+"星*"+e[0][1],0,0,174,70);return t.push(o),t}if(2==e.length){var r=this.createLabel(e[0][0]+"星*"+e[0][1],0,0,174,35);t.push(r);var a=this.createLabel(e[1][0]+"星*"+e[1][1],0,35,174,35);return t.push(a),t}if(3==e.length){var r=this.createLabel(e[0][0]+"星*"+e[0][1],0,0,87,35);t.push(r);var a=this.createLabel(e[1][0]+"星*"+e[1][1],87,0,87,35);t.push(a);var i=this.createLabel(e[2][0]+"星*"+e[2][1],0,35,87,35);return t.push(i),t}if(4==e.length){var r=this.createLabel(e[0][0]+"星*"+e[0][1],0,0,87,35);t.push(r);var a=this.createLabel(e[1][0]+"星*"+e[1][1],87,0,87,35);t.push(a);var i=this.createLabel(e[2][0]+"星*"+e[2][1],0,35,87,35);t.push(i);var s=this.createLabel(e[3][0]+"星*"+e[3][1],87,35,87,35);return t.push(s),t}return t},t.prototype.createLabel=function(e,t,n,o,r){var a=new eui.Label;return a.text=e,a.width=o,a.height=r,a.x=t,a.y=n,a.textColor=9268297,a.textAlign=egret.HorizontalAlign.CENTER,a.verticalAlign=egret.VerticalAlign.MIDDLE,a.size=24,a},t}(BasePanel);__reflect(DkSingResultUI.prototype,"DkSingResultUI");var loadGame=function(e){function t(){var t=e.call(this)||this;return t.skinName="PreloadPanelSkin",t}return __extends(t,e),t.prototype.onEnable=function(){},t.prototype.onRemove=function(){},t.prototype.setProgress=function(e){this.loadProgress.value=e},t}(BaseScene);__reflect(loadGame.prototype,"loadGame");var CardFactory=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();__reflect(CardFactory.prototype,"CardFactory");var CardData=function(e){function t(){var t=e.call(this)||this;return t.bUp=!1,t.isMouseDown=!0,t.isTouch=!1,t.skinName="CardSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchBrandCall,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd1,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onCreatCard,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},t.prototype.onCreatCard=function(){},t.prototype.touchEnd1=function(){this.parent.parent.isMouseDownChangeTrue()},t.prototype.touchMove=function(){this.isMouseDown&&this.touchBrandCall(null)},t.prototype.touchOutside=function(e){},t.prototype.touchBrandCall=function(e){console.log("点击牌："),App.SoundManager.playEffect("dapaiba_mp3"),this.isTouch?(this.isTouch=!1,this.y=0,this.isMouseDown=!1):(this.isTouch=!0,this.y=-50,this.isMouseDown=!1)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchBrandCall,this),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onCreatCard,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},t.prototype.setHandSkin=function(e,t){void 0===t&&(t=0),1==GameData.isWatcher&&1!=t?this.img_cardbg.visible=!0:this.img_cardbg.visible=!1;var n=e.type,o=e.value;this.cardsValue=o,this.cardsType=n,1==n||3==n?o>10&&14>o?(this.img_flower.visible=!0,this.img_number.source="1_"+o+"_png",this.img_Flower.source=o+"_"+n+"_png",this.img_flower.source=n+"_png"):61==o||62==o?(this.img_Flower.source=o+"_0_png",this.img_number.source="0_"+o+"_png",this.img_flower.visible=!1):(this.img_flower.visible=!0,this.img_Flower.source=n+"_png",this.img_flower.source=n+"_png",this.img_number.source="1_"+o+"_png"):o>10&&14>o?(this.img_flower.visible=!0,this.img_number.source="2_"+o+"_png",this.img_Flower.source=o+"_"+n+"_png",this.img_flower.source=n+"_png"):61==o||62==o?(this.img_Flower.source=o+"_0_png",this.img_number.source="0_"+o+"_png",this.img_flower.visible=!1):(this.img_flower.visible=!0,this.img_Flower.source=n+"_png",this.img_flower.source=n+"_png",this.img_number.source="2_"+o+"_png")},t.prototype.setOutSkin=function(){this.width=60,this.height=86},t.prototype.setChangeSkin=function(e,t){void 0===e&&(e=26),void 0===t&&(t=36)},t.prototype.createFlag=function(){},t.prototype.select=function(){},t.prototype.unSelect=function(){},t.prototype.toUp=function(){0==this.bUp&&(this.y=-50,this.bUp=!0)},t.prototype.toDown=function(){1==this.bUp&&(this.y=0,this.bUp=!1)},t.prototype.toChangeStatus=function(){},t.prototype.recycle=function(){},t}(eui.Component);__reflect(CardData.prototype,"CardData");var CardTs=function(e){function t(){var t=e.call(this)||this;return t.skinName="CardTsSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.setHandSkin=function(e){var t=e.type,n=e.value;this.cardsValue=n,this.cardsType=t,1==t||3==t?n>10&&14>n?(this.img_number.source="1_"+n+"_png",this.img_flower.source=t+"_png"):61==n||62==n?this.img_number.source="0_"+n+"_png":(this.img_flower.source=t+"_png",this.img_number.source="1_"+n+"_png"):n>10&&14>n?(this.img_number.source="2_"+n+"_png",this.img_flower.source=t+"_png"):61==n||62==n?this.img_number.source="0_"+n+"_png":(this.img_flower.source=t+"_png",this.img_number.source="2_"+n+"_png")},t.prototype.setOutSkin=function(){this.width=50,this.height=37},t}(eui.Component);__reflect(CardTs.prototype,"CardTs");var ChatShowUI=function(e){function t(){var t=e.call(this)||this;return t.timer={},t.skinName="ChatShowUISkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.txtBgImgX=this.txtBgImg.x,this.txtBgImgY=this.txtBgImg.y},t.prototype.showMsg=function(e,t,n,o){if(this.txtBgImg.x=this.txtBgImgX,this.txtBgImg.y=this.txtBgImgY,this.visible=!0,this.time=Date.now(),0==n){this.faceImg.source="",this.contentLab.text=o;var r=GameSound.getChatSoundName(t,o);switch(App.SoundManager.playEffect(r),e){case UserPosition.L:this.leftSay(this.contentLab);break;case UserPosition.R:this.rightSay(this.contentLab);break;case UserPosition.Up:this.topSay(this.contentLab);break;case UserPosition.Down:this.mySay(this.contentLab)}egret.Tween.get(this).to({visible:!1},3e3)}else if(1==n){this.contentLab.text="",this.txtBgImg.source="";var a=o.substr(0,o.indexOf("_")).substr(8);switch(console.log("facenum"+a),console.log(o),this.facgif.removeChildren(),DragonBonesManager.getInstance().startDragon(this.facgif,"face","face","face","face","face"+a,"newAnimation",30,110,1,1,!1),e){case UserPosition.L:break;case UserPosition.R:this.rightSay1();break;case UserPosition.Up:break;case UserPosition.Down:}egret.Tween.get(this).to({visible:!1},3e3)}else 3==n&&(this.visible=!1)},t.prototype.leftSay=function(e){this.txtBgImg.source="leftsay_png",this.txtBgImg.width=e.width+50,this.txtBgImg.height=e.height+50,this.txtBgImg.y=-e.height/2-5},t.prototype.topSay=function(e){this.txtBgImg.source="topSay_png",this.txtBgImg.width=e.width+50,this.txtBgImg.height=e.height+50,this.txtBgImg.y=-e.height-12},t.prototype.mySay=function(e){this.txtBgImg.source="mysay_png",this.txtBgImg.width=e.width+50,this.txtBgImg.height=e.height+50,this.txtBgImg.y=-e.height/2-5},t.prototype.rightSay=function(e){this.txtBgImg.source="rightSay_png",this.txtBgImg.width=e.width+50,this.txtBgImg.height=e.height+50,this.txtBgImg.y=-e.height/2-5,this.txtBgImg.right=0,this.contentLab.right=10},t.prototype.rightSay1=function(){this.facgif.x=300},t}(eui.Component);__reflect(ChatShowUI.prototype,"ChatShowUI");var DKAct=function(e){function t(){var t=e.call(this)||this;return t.skinName="DKActUI",t}return __extends(t,e),t}(eui.Component);__reflect(DKAct.prototype,"DKAct");var Fight=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.init,t),t.skinName="FightSkin",t}return __extends(t,e),t.prototype.init=function(){var e=this;this.hideReck.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=e.LatelygameBtn.getChildAt(0);t.source="fightTopBg_png";var n=e.ReviewboardBtn.getChildAt(0);n.source="fightBtnBg_png",e.hideReck.visible=!1,egret.Tween.get(e.figGroup).to({x:0}).to({x:-567},400).call(function(){egret.Tween.removeTweens(e.figGroup),e.figGroup.visible=!1,e.visible=!1})},this),this.fanfightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=e.LatelygameBtn.getChildAt(0);t.source="fightTopBg_png";var n=e.ReviewboardBtn.getChildAt(0);n.source="fightBtnBg_png",e.hideReck.visible=!1,egret.Tween.get(e.figGroup).to({x:0}).to({x:-567},400).call(function(){egret.Tween.removeTweens(e.figGroup),e.figGroup.visible=!1,e.visible=!1})},this),this.LatelygameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.LatelygameFun,this),this.ReviewboardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ReviewboardFun,this)},t.prototype.LatelygameFun=function(){var e=this.LatelygameBtn.getChildAt(0);e.source="fightTopBg_png";var t=this.ReviewboardBtn.getChildAt(0);t.source="fightBtnBg_png";var n={cmd:"131017",type:"0"};App.gameSocket.send(n)},t.prototype.ReviewboardFun=function(){var e=this.LatelygameBtn.getChildAt(0);e.source="fightBtnBg_png";var t=this.ReviewboardBtn.getChildAt(0);t.source="fightTopBg_png";var n={cmd:"131017",type:"1"};App.gameSocket.send(n)},t.prototype.sendData=function(e){var t=e;this.listRank.dataProvider=new eui.ArrayCollection(t),this.listRank.itemRenderer=FightList},t}(eui.Component);__reflect(Fight.prototype,"Fight");var FightList=function(e){function t(){var t=e.call(this)||this;return t.skinName="FightListSkin",t}return __extends(t,e),t.prototype.dataChanged=function(){this.data&&(this.fightName.text=this.data.nickname.substr(0,4),this.fightScore.text=this.data.winScore)
},t}(eui.ItemRenderer);__reflect(FightList.prototype,"FightList");var HeadUI=function(e){function t(){var t=e.call(this)||this;return t.userID=0,t.skinName="HeadUISkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.setDownFun=function(){},t.prototype.onclickShutup=function(){},t.prototype.setHeadUiShutup=function(e){"game_say1_png"==this.headShutup.source},t.prototype.loadImg=function(e){e&&""!=e&&1!=e?(this.headImg.source=e,this.headImg.mask=this.headMask):this.headImg.source=null,this.setDownBtn.visible=!1,this.head_shareBtn.visible=!1},t.prototype.setupBtn=function(){this.setDownBtn.visible=!0,this.head_shareBtn.visible=!1},t.prototype.isEmpty=function(){return null==this.headImg.bitmapData?!0:!1},t.prototype.showDisOnLine=function(){console.log("托管状态"),this.disOnLineImg.visible=!0},t.prototype.hideDisOnLine=function(){this.disOnLineImg.visible=!1},t.prototype.showRank=function(e){e>3||(this.rankImg.source="match_"+e+"_png",this.rankImg.visible=!0)},t.prototype.hideRank=function(){this.rankImg.visible=!1},t.prototype.clear=function(){this.headImg.bitmapData=null,this.headImg.texture=null,this.headImg.source=null,this.userID=-1,this.nameLabel.text="",this.scoreLabel.text="",this.tuoGuanIcon.visible=!1,this.headQuestionImg.visible=!0},t.prototype.hide=function(){this.headShutup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onclickShutup,this),this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(HeadUI.prototype,"HeadUI");var Invitation=function(e){function t(){var t=e.call(this)||this;return t.skinName="InvitationSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touch,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),console.log("注册点击事件")},t.prototype.onAddToStage=function(e){var t=egret.Tween.get(this.arrow,{loop:!0});t.to({x:1187},500)},t.prototype.touch=function(e){switch(console.log("进入点击事件"),e.target){case e.target:this.close()}},t.prototype.close=function(){App.PopUpManager.removePopUp(this)},t}(BasePanel);__reflect(Invitation.prototype,"Invitation");var OutTimeUI=function(e){function t(){var t=e.call(this)||this;return t.limitTime=25,t.skinName="OutTimeUISkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.outTimer=new DateTimer(1e3,this.limitTime)},t.prototype.startTime=function(){this.outTimer.reset(),this.setCDLab(this.limitTime.toString()),this.outTimer.addEventListener(egret.TimerEvent.TIMER,this.onOutTime,this),this.outTimer.start()},t.prototype.stopTime=function(){this.outTimer.removeEventListener(egret.TimerEvent.TIMER,this.onOutTime,this),this.outTimer.stop()},t.prototype.onOutTime=function(e){if(this.outTimer.currentCount>this.limitTime)return void this.stopTime();var t=this.limitTime-this.outTimer.currentCount;this.setCDLab(NumberTool.formatTime(t)+"")},t.prototype.setCDLab=function(e){this.cdLab1.text=e},t}(eui.Component);__reflect(OutTimeUI.prototype,"OutTimeUI");var ResidueUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="ResidueUISkin",t}return __extends(t,e),t.prototype.setRemainCard=function(e){this.remainLab.text=e.toString()},t}(eui.Component);__reflect(ResidueUI.prototype,"ResidueUI");var RuleRoom=function(e){function t(){var t=e.call(this)||this;return t.skinName="RuleRoomSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.addEventListener("touchTap",this.touch,this),console.log("注册点击事件")},t.prototype.touch=function(e){switch(console.log("进入点击事件"),e.target){case this.btn_close:this.close()}},t.prototype.close=function(){App.PopUpManager.removePopUp(this)},t}(BasePanel);__reflect(RuleRoom.prototype,"RuleRoom");var Share=function(e){function t(){var t=e.call(this)||this;return t.skinName="ShareSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touch,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),console.log("注册点击事件")},t.prototype.onAddToStage=function(e){var t=egret.Tween.get(this.arrow,{loop:!0});t.to({x:1172},500)},t.prototype.touch=function(e){switch(console.log("进入点击事件"),e.target){case e.target:this.close()}},t.prototype.close=function(){App.PopUpManager.removePopUp(this)},t}(BasePanel);__reflect(Share.prototype,"Share");var topGame=function(e){function t(){var t=e.call(this)||this;return t.skinName="TopGameSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touch,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),console.log("注册点击事件")},t.prototype.onAddToStage=function(e){var t=egret.Tween.get(this.arrow,{loop:!0});t.to({x:1172},500)},t.prototype.touch=function(e){switch(console.log("进入点击事件"),e.target){case e.target:this.close()}},t.prototype.close=function(){App.PopUpManager.removePopUp(this)},t}(BasePanel);__reflect(topGame.prototype,"topGame");var Watcher=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.init,t),t.skinName="watchSkin",t}return __extends(t,e),t.prototype.init=function(){var e=this;this.hideReck.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.hideReck.visible=!1,egret.Tween.get(e.scollGrop).to({x:0}).to({x:-567},400).call(function(){egret.Tween.removeTweens(e.scollGrop),e.scollGrop.visible=!1,e.visible=!1})},this),this.fanhuifightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.hideReck.visible=!1,egret.Tween.get(e.scollGrop).to({x:0}).to({x:-567},400).call(function(){egret.Tween.removeTweens(e.scollGrop),e.scollGrop.visible=!1,e.visible=!1})},this)},t.prototype.sendData=function(e){for(var t=0;t<e.length;t++);this.howNum.text="  ("+t+")";var n=e;this.listRank.dataProvider=new eui.ArrayCollection(n),this.listRank.itemRenderer=WatchList},t}(eui.Component);__reflect(Watcher.prototype,"Watcher");var WatchList=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.init,t),t.skinName="watchListSkin",t}return __extends(t,e),t.prototype.init=function(){},t.prototype.dataChanged=function(){this.data&&(this.data.nickname.length>5?this.watchname.text=this.data.nickname.substr(0,4):this.watchname.text=this.data.nickname,this.watchhead.source=this.data.headImgUrl,this.watchhead.mask=this.watchmask)},t}(eui.ItemRenderer);__reflect(WatchList.prototype,"WatchList");var HallController=function(e){function t(){var t=e.call(this)||this;return t.isReconnection=!1,t}return __extends(t,e),t.prototype.onRegister=function(){this.addEvent(t.EVENT_SHOW_HALL,this.showHallScene,this),this.addEvent(t.EVENT_13_DAO,this.enter13Dao,this)},t.prototype.registerSocket=function(){var e=App.gameSocket;e.register(ProtocolHead.CMD131001,this.createRoom,this),e.register(ProtocolHead.CMD131002,this.joinRoom,this),this.addEvent(EventConst.SocketConnect,this.onSocketConnect,this),this.addEvent(EventConst.SocketIOError,this.onSocketError,this)},t.prototype.onShareOK=function(e){App.DataCenter.UserInfo.httpUserInfo.isFirstShare=!1,Tips.info("恭喜你获得"+parseInt(e.msg[0].roomCard)+"个棒棒糖"),App.DataCenter.UserInfo.httpUserInfo.gold+=parseInt(e.msg[0].roomCard),null!=this.hallScene&&this.hallScene.setUserInfoUI()},t.prototype.reConnected=function(e){this.hallScene.connectedComplete(e)},t.prototype.enter13Dao=function(){SocketHelper.initSocket(App.gameSocket.enterScoketTo13Dao()),Sound.soundChannelBg=App.SoundManager.getbgmChannel(),App.SceneManager.runScene(SceneConst.ThridGameScene)},t.prototype.revEnter13Dao=function(e){this.enter13Dao(),SocketHelper.onmessage(JSON.stringify(e))},t.prototype.revMarquee=function(e){var t=this,n=e.msg[0];n.forEach(function(e){t.hallScene.marquee.push(e)})},t.prototype.onSocketConnect=function(e){},t.prototype.onSocketError=function(e){e==App.gameSocket&&(console.log("网络连接失败，请检查您的网络。"),App.MsgBoxManager.getBoxA().showMsg("网络连接失败，请检查您的网络。"))},t.prototype.joinRoom=function(e){var t=App.DataCenter.UserInfo.httpUserInfo.errorCode=e.errorCode,n=App.DataCenter.UserInfo.httpUserInfo.room=e.room;if(0==t){App.DataCenter.UserInfo.deleteAllUserExcptMe(),App.PanelManager.closeAllPanel(),App.MsgBoxManager.recycleAllBox();var o=n.roomId,r=App.DataCenter.UserInfo.httpUserInfo.seatMap=n.seatMap,a=n.startTime,i=n.time;for(var s in r){var p=r[s],c=p.player,l=c.roleId,h=App.DataCenter.UserInfo.httpUserInfo.roleId;if(h==l){App.DataCenter.UserInfo.httpUserInfo.seat=p.seat;var c=p.player,u=c.headImgUrl,g=c.nickname,d=c.sex,m=App.DataCenter.UserInfo.httpUserInfo.seat;App.DataCenter.UserInfo.httpUserInfo.time=i,App.DataCenter.UserInfo.httpUserInfo.startTime=a,App.DataCenter.UserInfo.httpUserInfo.roomId=o,App.DataCenter.UserInfo.httpUserInfo.nickName=g,App.DataCenter.UserInfo.httpUserInfo.headImgUrl=u,App.DataCenter.UserInfo.httpUserInfo.sex=d,App.DataCenter.UserInfo.httpUserInfo.seat=m}}App.getInstance().sendEvent(DKGameController.EVENT_SHOW_GAME_SCENE)}},t.prototype.revERoomErr=function(e){8==e.cmd?App.MsgBoxManager.getBoxA().showMsg("房间不存在!!!"):47==e.cmd&&App.MsgBoxManager.getBoxA().showMsg("加入失败，房间人满!!!")},t.prototype.createRoom=function(e){App.DataCenter.UserInfo.deleteAllUserExcptMe();var t=App.DataCenter.UserInfo.httpUserInfo.errorCode=e.errorCode;if(App.PanelManager.closeAllPanel(),App.MsgBoxManager.recycleAllBox(),0==t){var n=App.DataCenter.UserInfo.httpUserInfo.room=e.room,o=n.roomId,r=n.seatMap,a=n.startTime,i=n.time,s=r[1],p=s.player,c=p.headImgUrl,l=p.nickname,h=p.sex,u=s.seat;App.DataCenter.UserInfo.httpUserInfo.time=i,App.DataCenter.UserInfo.httpUserInfo.startTime=a,App.DataCenter.UserInfo.httpUserInfo.roomId=o,App.DataCenter.UserInfo.httpUserInfo.nickName=l,App.DataCenter.UserInfo.httpUserInfo.headImgUrl=c,App.DataCenter.UserInfo.httpUserInfo.sex=h,App.DataCenter.UserInfo.httpUserInfo.seat=u,App.getInstance().sendEvent(DKGameController.EVENT_SHOW_GAME_SCENE)}else App.MsgBoxManager.getBoxA().showMsg("您的棒棒糖已不足，请联系客服充值，现在充值享优惠。\r\n客服微信:hu309954519")},t.prototype.onRemove=function(){},t.prototype.showHallScene=function(){this.registerSocket(),App.PanelManager.close(PanelConst.SetPanel),this.hallScene=App.SceneManager.runScene(SceneConst.HallScene,this)},t.prototype.sendEnterRoom=function(e){ProtocolData.CMD131001.time[0].roomId=e,App.gameSocket.send(ProtocolData.CMD131001)},t.prototype.revroomCard=function(e){App.DataCenter.UserInfo.httpUserInfo.gold=e.msg[0].roomCard,this.hallScene.setRoomCard()},t.prototype.exitRoom13Dao=function(){App.SoundManager.bgmVolume=App.SoundManager.getbgmChannel().volume,App.gameSocket.send({cmd:102}),App.gameSocket.exitScoketFrom13Dao(),App.getInstance().sendEvent(t.EVENT_SHOW_HALL)},t.prototype.inviteRoom13Dao=function(){var e=App.DataCenter.UserInfo.httpUserInfo.roomId.toString(),t=App.DataCenter.UserInfo.httpUserInfo.serverId,n={cmd:"share",data:{}},o={shareWay:0,title:"游艺斯",webpageUrl:"http://hj.vequn.org/html.php?g=Admin&m=Public&a=app",description:"游艺斯"},r="经典双扣";0==t?r="经典双扣":1==t?r="百变双扣":2==t&&(r="十三道"),o.title=r,n.data=o,o.description="游艺斯好友邀请房号:"+e+"最好玩的棋牌游戏\r\n游戏模式："+r+"\r\n局数：",egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&egret.ExternalInterface.call("sendToNative",JSON.stringify(n))},t.prototype.shareRoom13Dao=function(e){if(egret.Capabilities.runtimeType==egret.RuntimeType.WEB);else{var t={cmd:"share",data:{}},n={shareWay:0,title:"游艺斯我的战绩",webpageUrl:"http://hj.vequn.org/html.php?g=Admin&m=Public&a=app",description:e};t.data=n,egret.ExternalInterface.call("sendToNative",JSON.stringify(t))}},t.NAME="HallController",t.EVENT_SHOW_HALL="ShowHallScene",t.EVENT_13_DAO="Enter13Dao",t}(BaseController);__reflect(HallController.prototype,"HallController");var HallScene=function(e){function t(){var t=e.call(this)||this;return t.isFirst=!0,t.reConnectPanel=new ConnectPanel,t.reConnectedTimer=new egret.Timer(2e3),t.reconnetCount=0,t.skinName="HallSceneSkin",t}return __extends(t,e),t.prototype.onEnable=function(){var e=this.btn_icon.getChildByName("icon");e.source=App.DataCenter.logoUrl,this.setUserInfoUI(),this.addEventListener("touchTap",this.onTouchTap,this),this.btn_weiChat.addEventListener("touchTap",this.onWechatShare,this),this.btn_closeShare.addEventListener("touchTap",this.onClick,this),this.checkShareRoom(),this.reConnectedTimer.addEventListener(egret.TimerEvent.TIMER,this.reConnectedStart,this),this.reConnectedTimer.start()},t.prototype.onClick=function(){this.shareGroup.visible=!1},t.prototype.onWechatShare=function(){if(egret.Capabilities.runtimeType==egret.RuntimeType.WEB)this.shareImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.shareImg.visible=!0;else{App.DataCenter.sendMsg=!0;var e={cmd:"share",data:{}},t=(new Date).getTime()+"send",n={shareWay:0,title:"游艺斯",webpageUrl:"http://hj.vequn.org/html.php?g=Admin&m=Public&a=app",description:"最好玩的棋牌游戏",transaction:t};e.data=n,egret.ExternalInterface.call("sendToNative",JSON.stringify(e))}},t.prototype.onShare=function(){this.shareImg.visible=!1,this.shareImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this)},t.prototype.childrenCreated=function(){},t.prototype.onRemove=function(){this.reConnectedTimer.stop()},t.prototype.checkShareRoom=function(){if(this.isFirst){this.isFirst=!1;var e=App.DataCenter.shareInfo.roomId;e&&this.ctrl.sendEnterRoom(e)}},t.prototype.setUserInfoUI=function(){if(App.DataCenter.UserInfo.httpUserInfo.isFirstShare?this.shareGroup.visible=!0:this.shareGroup.visible=!1,!App.DataCenter.debugInfo.isDebug){var e=App.DataCenter.UserInfo.getMyUserVo();e&&(this.userIdLab.text=e.roleId.toString(),this.nickNameLab.text=e.nickName,this.roomCardLab.text=e.gold.toString(),this.headImg.source=e.headImgUrl)}},t.prototype.setRoomCard=function(){this.roomCardLab&&(this.roomCardLab.text=App.DataCenter.UserInfo.httpUserInfo.gold+"")},t.prototype.onTouchTap=function(e){switch(e.target){case this.msgBtn:App.PanelManager.open(PanelConst.MsgPanel);break;case this.setBtn:App.PanelManager.open(PanelConst.SetPanel);break;case this.ruleBtn:App.PanelManager.open(PanelConst.RulePanel);break;case this.scoreBtn:App.PanelManager.open(PanelConst.ScorePanel);break;case this.croomBtn:App.PanelManager.open(PanelConst.CroomPanle);break;case this.eroomBtn:App.PanelManager.open(PanelConst.EroomPanel);break;case this.recharge_img:case this.roomCardLab:case this.userIdLab:App.PanelManager.open(PanelConst.PayPanel);break;case this.headImg:App.PanelManager.open(PanelConst.PersionInfoPanel)}},t.prototype.connectedComplete=function(e){this.reconnetCount=0,console.log("data:"+e);var t=this.getChildByName("connectPanel");null!=t&&this.removeChild(t)},t.prototype.reConnected=function(){this.reConnectPanel.text="断线重连中,请稍后。。。",this.addChild(this.reConnectPanel)},t.prototype.reConnectedStart=function(){},t}(BaseScene);__reflect(HallScene.prototype,"HallScene");var AwardPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="AwardSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter(),this.closeBtn.addEventListener("touchTap",this.hide,this)},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(AwardPanel.prototype,"AwardPanel");var ConnectPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="ConnectPanelSkin",t.name="connectPanel",t}return __extends(t,e),Object.defineProperty(t.prototype,"text",{set:function(e){this.connectTxt.text=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(ConnectPanel.prototype,"ConnectPanel");var CroomPanels=function(e){function t(){var t=e.call(this)||this;return t.gameSelected=0,t.gameType=15,t.round=10,t.roomCard=1,t.gameListArr=[{gameType:0,rounds:[{round:4,roomCard:1},{round:8,roomCard:2},{round:16,roomCard:3}]},{gameType:1,rounds:[{round:4,roomCard:1},{round:8,roomCard:2},{round:16,roomCard:3}]},{gameType:2,rounds:[{round:10,roomCard:1},{round:20,roomCard:2}]}],t.skinName="CreateroomSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.btn_three.selected=!0,this.btn_ten.selected=!0,this.btn_jddk.selected=!0,this.threeGroup.visible=!0,this.txt_roomcard.text="2"},t.prototype.onEnable=function(){this.btn_dk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameSelectedClick,this),this.btn_three.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameSelectedClick,this),this.btn_four.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roundSelected,this),this.btn_eight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roundSelected,this),this.btn_sixteen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roundSelected,this),this.btn_jddk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameSelectedClick,this),this.btn_bbdk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameSelectedClick,this),this.btn_ten.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roundSelected,this),this.btn_tweenty.addEventListener(egret.TouchEvent.TOUCH_TAP,this.roundSelected,this),this.btn_ok.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btn_ok:this.sendData(),this.hide();break;case this.btn_close:this.hide()}},t.prototype.gameSelectedClick=function(e){switch(e.currentTarget){case this.btn_bbdk:this.gameType=15;break;case this.btn_jddk:this.gameType=15;break;case this.btn_three:this.count_img.texture=RES.getRes("cr_icon_tips2_png"),this.dkGroup.visible=!1,this.threeGroup.visible=!0,this.gameSelected=0,this.gameType=15,this.btn_ten.selected=!0,this.round=10,this.txt_roomcard.text="2";break;case this.btn_dk:this.count_img.texture=RES.getRes("cr_icon_tips_png"),this.gameSelected=0,this.dkGroup.visible=!0,this.threeGroup.visible=!1,this.btn_four.selected=!0,this.txt_roomcard.text="1",this.btn_jddk.selected=!0,this.gameType=15,this.round=4}},t.prototype.roundSelected=function(e){var t=1;switch(e.currentTarget){case this.btn_eight:this.round=8,t=2;break;case this.btn_four:this.round=4,t=1;break;case this.btn_sixteen:this.round=16,t=3;break;case this.btn_tweenty:this.round=20,t=4;break;case this.btn_ten:this.round=10,t=2}this.roomCard=t,this.txt_roomcard.text=""+t},t.prototype.sendData=function(){ProtocolData.CMD131001.time=this.gameType,App.gameSocket.send(ProtocolData.CMD131001)},t}(BasePanel);__reflect(CroomPanels.prototype,"CroomPanels");var ERoomPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="ERoomSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter(),this.closeBtn.addEventListener("touchTap",this.hide,this),this.resetBtn.addEventListener("touchTap",this.onReset,this),this.delBtn.addEventListener("touchTap",this.onDel,this),this.noGroup.addEventListener("touchTap",this.onNoGroup,this),this.onReset()},t.prototype.onReset=function(){for(var e=this.roomNoGroup.numChildren,t=e-1;t>=e-6;t--){var n=this.roomNoGroup.getChildAt(t);""!=n.text&&null!=n.text&&(n.text="")}},t.prototype.onDel=function(){for(var e=this.roomNoGroup.numChildren,t=e-1;t>=e-6;t--){var n=this.roomNoGroup.getChildAt(t);if(""!=n.text&&null!=n.text){n.text="";break}}},t.prototype.onNoGroup=function(e){if(e.target instanceof eui.Button){var t=e.target;if(console.log(t.label),null!=t.label&&""!=t.label)for(var n=this.roomNoGroup.numChildren,o=6;n>o;o++){var r=this.roomNoGroup.getChildAt(o);if(""==r.text||null==r.text){r.text=t.label,o==n-1&&this.sendData();break}}}},t.prototype.sendData=function(){for(var e="",t=this.roomNoGroup.numChildren,n=6;t>n;n++){var o=this.roomNoGroup.getChildAt(n);e+=o.text}ProtocolData.CMD131002.roomId=Number(e),App.gameSocket.send(ProtocolData.CMD131002),this.hide()},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(ERoomPanel.prototype,"ERoomPanel");var InvitePanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="invitePanelSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.setCenter(),this.percentWidth=100,this.percentHeight=100,this.addEventListener("touchTap",this.hide,this),console.log("进入了")},t}(BasePanel);__reflect(InvitePanel.prototype,"InvitePanel");var Marquee=function(e){function t(){var t=e.call(this)||this;return t.skinName="MarqueeSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.init()},t.prototype.init=function(){this.rollingArray=[],this.IsRolling=!1,this.rockLab.mask=this.rockMark,this.rockLab.x=this.width,this.v=.07},t.prototype.onEnable=function(){this.IsRolling||this.startRolling()},t.prototype.startRolling=function(){for(var e=this,t=App.DataCenter.marqueeInfo.messageMarquee,n="",o=0;o<t.length;o++)n+=t[o]+"";this.rockLab.text=n,""!=n&&(egret.Tween.get(e.rockLab,{loop:!0}).to({x:-e.rockLab.width},(e.rockMark.width+e.rockLab.width)/e.v),e.IsRolling=!0)},t.prototype.push=function(e,t){void 0===t&&(t=1),App.DataCenter.marqueeInfo.messageMarquee.push(e),this.startRolling()},t.prototype.stopRolling=function(){egret.Tween.removeTweens(this.rockLab),this.IsRolling=!1},t.prototype.onRemove=function(){this.stopRolling()},t}(BaseUI);__reflect(Marquee.prototype,"Marquee");var MessagePanel=function(e){function t(){var t=e.call(this)||this;return t.cmd="44",t.skinName="MessageSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter()},t.prototype.sendData=function(){var e=ProtocolData.commond;e.cmd=this.cmd,e.game="-1",App.gameSocket.send(ProtocolData.commond)},t.prototype.rev42Data=function(e){this.newActLab.text=e.msg[0][0].content},t.prototype.rev43Data=function(e){this.sysMsgLab.text=e.msg[0][0].content},t.prototype.changeViewStack=function(e){var t=e.target;this.vs.selectedIndex=t.selectedValue},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(MessagePanel.prototype,"MessagePanel");var PayPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="PayPanelSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.closeBtn.addEventListener("touchTap",this.hide,this),this.radiosRbt.group.addEventListener(eui.UIEvent.CHANGE,this.changeViewStack,this)},t.prototype.onEnable=function(){this.setCenter()},t.prototype.changeViewStack=function(e){var t=e.target;this.vs.selectedIndex=t.selectedValue},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(PayPanel.prototype,"PayPanel");var PersionInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="PersonInfoSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter(),this.setUserInfoUI(),this.closeBtn.addEventListener("touchTap",this.hide,this)},t.prototype.setUserInfoUI=function(){var e=App.DataCenter.UserInfo.getMyUserVo();e&&(this.userIdLab.text=e.roleId.toString(),this.nickNameLab.text=e.nickName,this.roomCardLab.text=e.gold.toString(),this.headImg.source=e.headImgUrl)},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(PersionInfoPanel.prototype,"PersionInfoPanel");var RulePanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="RulePanelSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){this.setCenter(),this.closeBtn.addEventListener("touchTap",this.hide,this),this.radioRbt.group.addEventListener(eui.UIEvent.CHANGE,this.changeViewStack,this)},t.prototype.changeViewStack=function(e){var t=e.target;this.vs.selectedIndex=t.selectedValue},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(RulePanel.prototype,"RulePanel");var ScoreItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.childrenCreated=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.dataChanged=function(){this.setUIData()},t.prototype.setUIData=function(){this.dateLab.text=this.data.date,this.roomNoLab.text=this.data.roomId,this.timeLab.text=this.data.time,this.firstNickNameLab.text=this.data.firstNickName,this.secondNickNameLab.text=this.data.secondNickName,this.thridNickNameLab.text=this.data.thridNickName,this.fourthNickNameLab.text=this.data.fourthNickName,this.firstScoreLab.text=this.formatScore(this.data.firstScore),this.secondScoreLab.text=this.formatScore(this.data.secondScore),this.thridScoreLab.text=this.formatScore(this.data.thridScore),this.fourthScoreLab.text=this.formatScore(this.data.fourthScore)},t.prototype.formatScore=function(e){return e>0?"+"+e:""+e},t.prototype.onTouch=function(e){},t}(eui.ItemRenderer);__reflect(ScoreItem.prototype,"ScoreItem");var ScorePanel=function(e){function t(){var t=e.call(this)||this;return t.cmd="41",t.skinName="ScorePanelSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onEnable=function(){},t.prototype.sendData=function(){var e=ProtocolData.commond;e.cmd=this.cmd,e.game="-1",App.gameSocket.send(ProtocolData.commond)},t.prototype.revData=function(e){switch(this.scoreType){case 0:this.setDkScore(e.msg[0]);break;case 1:this.setHdkScore(e.msg[0]);break;case 2:this.set13Score(e.msg[0])}this.scoreType++},t.prototype.setDkScore=function(e){var t=this.dkScoreList.dataProvider;e.forEach(function(e){t.addItem(e)})},t.prototype.setHdkScore=function(e){var t=this.hdkScoreList.dataProvider;e.forEach(function(e){t.addItem(e)})},t.prototype.set13Score=function(e){var t=this.thridScoreList.dataProvider;e.forEach(function(e){t.addItem(e)})},t.prototype.changeViewStack=function(e){var t=e.target;this.vs.selectedIndex=t.selectedValue},t.prototype.onRemove=function(){},t}(BasePanel);__reflect(ScorePanel.prototype,"ScorePanel");var LbSetPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="LbSetPanelSkin",t}return __extends(t,e),t.prototype.onEnable=function(){var e=this;this.setCenter(),this.btnState(),this.closeBtn.addEventListener("touchTap",this.hide,this),this.toggle_music.addEventListener(eui.UIEvent.CHANGE,this.onChangeMusic,this),this.toggle_sound.addEventListener(eui.UIEvent.CHANGE,this.onChangeSound,this),this.once(egret.Event.REMOVED_FROM_STAGE,function(){egret.localStorage.setItem("sk_music",JSON.stringify([e.toggle_music.selected,e.toggle_sound.selected]))},this)},t.prototype.onChangeMusic=function(){this.toggle_music.selected?App.SoundManager.bgmVolume=0:App.SoundManager.bgmVolume=1},t.prototype.onChangeSound=function(){this.toggle_sound.selected?App.SoundManager.effectVolume=0:App.SoundManager.effectVolume=1},t.prototype.btnState=function(){this.toggle_music.selected=0==App.SoundManager.bgmVolume,this.toggle_sound.selected=0==App.SoundManager.effectVolume},t}(BasePanel);__reflect(LbSetPanel.prototype,"LbSetPanel");var PreloadPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="PreloadPanelSkin",t}return __extends(t,e),t.prototype.onEnable=function(){},t.prototype.onRemove=function(){},t.prototype.setProgress=function(e){window.parent.postMessage({forLobby:!0,cmd:"loading",percent:e},"*")},t}(BaseScene);__reflect(PreloadPanel.prototype,"PreloadPanel");var LoginController=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onRegister=function(){this.addEvent(t.EVENT_SHOW_LOGIN,this.showLoginScene,this),this.registerSocket()},t.prototype.registerSocket=function(){var e=App.gameSocket;e.register(ProtocolHead.CMD100006,this.revLogin,this),e.register(ProtocolHead.CMD101002,this.gotoHall,this),e.register(ProtocolHead.CMD131002,this.joinRoom,this),this.addEvent(EventConst.SocketConnect,this.onSocketConnect,this),this.addEvent(EventConst.SocketIOError,this.onSocketError,this)},t.prototype.joinRoom=function(e){App.DataCenter.UserInfo.httpUserInfo.roleId=parseInt(egret.getOption("roleId"));var t=App.DataCenter.UserInfo.httpUserInfo.errorCode=e.errorCode,n=App.DataCenter.UserInfo.httpUserInfo.room=e.room;if(GameData.roomstats=n.roomStatus,GameData.jiju=n.totalRound,GameData.yida=n.round,GameData.isAA=n.aa,GameData.remainTime=Math.ceil(e.dissovleLeftTime/1e3),GameData.hnad=e.hand,console.log("断线重连手牌：",GameData.hnad),GameData.isAgree=n.dissolveMap,console.log("断线重连解散房间同意玩家：",GameData.isAgree),GameData.endTime=e.endTime,App.DataCenter.UserInfo.httpUserInfo.roomId=n.roomId,GameData.lastPlayCard=n.lastPlayCard,GameData.lastPlayerSeat=n.lastPlayerSeat,GameData.playSeat=n.playSeat,0==t){console.log("room enter"),App.DataCenter.UserInfo.deleteAllUserExcptMe(),App.PanelManager.closeAllPanel(),App.MsgBoxManager.recycleAllBox();var o=n.roomId,r=App.DataCenter.UserInfo.httpUserInfo.seatMap=n.seatMap;if(App.DataCenter.UserInfo.httpUserInfo.user=r,GameData.allPlayerInfo=r,0!=r.lenth){for(var a in r)if(GameData.peopleNum.push(r[a].player.roleId),1==r[a].offline&&GameData.offLinePlayer.push(r[a].seat),parseInt(egret.getOption("roleId"))==r[a].player.roleId){for(var i in r[a].tip)GameData.tishiCardArr.push(r[a].tip[i]);GameData.isWatcher=!1}var s=n.startTime,p=n.time;for(var c in r){var l=r[c],h=l.player,u=h.roleId,g=App.DataCenter.UserInfo.httpUserInfo.roleId=parseInt(egret.getOption("roleId"));if(g==u){App.DataCenter.UserInfo.httpUserInfo.seat=l.seat,GameData.hasGuoBtn=l.canPass,GameData.iswinOrder=l.winOrder;var h=l.player,d=h.headImgUrl,m=h.nickname,f=h.sex;App.DataCenter.UserInfo.httpUserInfo.score=l.score;var v=App.DataCenter.UserInfo.httpUserInfo.seat;App.DataCenter.UserInfo.httpUserInfo.time=p,App.DataCenter.UserInfo.httpUserInfo.startTime=s,App.DataCenter.UserInfo.httpUserInfo.roomId=o,App.DataCenter.UserInfo.httpUserInfo.nickName=m,-1!=d.indexOf("http")?App.DataCenter.UserInfo.httpUserInfo.headImgUrl=d:App.DataCenter.UserInfo.httpUserInfo.headImgUrl="touxiang_png",App.DataCenter.UserInfo.httpUserInfo.sex=f,App.DataCenter.UserInfo.httpUserInfo.seat=v,App.DataCenter.UserInfo.httpUserInfo.ready=l.ready}}}App.getInstance().sendEvent(DKGameController.EVENT_SHOW_GAME_SCENE)}},t.prototype.revShareMessage=function(){App.DataCenter.UserInfo.httpUserInfo.isFirstShare=!0},t.prototype.revLogin=function(e){var t=e.player;App.DataCenter.UserInfo.httpUserInfo.gameStatus=t.gameStatus,App.DataCenter.UserInfo.httpUserInfo.gold=t.gold,App.DataCenter.UserInfo.httpUserInfo.headImgUrl=t.headImgUrl,App.DataCenter.UserInfo.httpUserInfo.isCheck=t.isCheck,App.DataCenter.UserInfo.httpUserInfo.lastCheckTime=t.lastCheckTime,App.DataCenter.UserInfo.httpUserInfo.loginTime=t.loginTime,App.DataCenter.UserInfo.httpUserInfo.netStatus=t.netStatus,App.DataCenter.UserInfo.httpUserInfo.nickName=t.nickname,App.DataCenter.UserInfo.httpUserInfo.openId=t.openId,App.DataCenter.UserInfo.httpUserInfo.platform=t.platform,App.DataCenter.UserInfo.httpUserInfo.registerPlatform=t.registerPlatform,App.DataCenter.UserInfo.httpUserInfo.roleId=t.roleId,App.DataCenter.UserInfo.httpUserInfo.roomId=t.roomId,App.DataCenter.UserInfo.httpUserInfo.serverId=t.serverId,App.DataCenter.UserInfo.httpUserInfo.sex=t.sex,App.DataCenter.UserInfo.httpUserInfo.totalCheck=t.totalCheck,App.DataCenter.UserInfo.httpUserInfo.roomId},t.prototype.reConnection=function(e){App.DataCenter.UserInfo.httpUserInfo.serverId=e.game;var t=e.msg[0];if(App.DataCenter.UserInfo.httpUserInfo.roomId=t.roomId,2==e.game){App.getInstance().sendEvent(HallController.EVENT_13_DAO);var n={cmd:"36",game:e.game,msg:[{openId:" ",nickname:" ",headImgUrl:" "}]},o=App.DataCenter.UserInfo.httpUserInfo;n.msg[0].openId=o.openId,n.msg[0].nickname=o.nickName,n.msg[0].headImgUrl=o.headImgUrl,App.gameSocket.send(n)}else App.DataCenter.GameInfo.isReCon=!0,App.getInstance().sendEvent(DKGameController.EVENT_SHOW_GAME_SCENE)},t.prototype.onLogin=function(){App.gameSocket.startConnect(App.DataCenter.ServerInfo.GAME_SERVER,!1)},t.prototype.playInfo=function(e){e=this.player,console.log("参数参数》》》》》》》》》》》》》"+this.player)},t.prototype.onSocketConnect=function(e){var t;0==this.player?t={cmd:101002,roleId:11111,sign:"b4efc6ee9e27d16b955647c3b0357ee4"}:1==this.player?t={cmd:101002,roleId:22222,sign:"aa8c6563d960032c56c9215388d1d16e"}:2==this.player?t={cmd:101002,roleId:33333,sign:"60c2966766e0a46db3c982cd28f02deb"}:3==this.player?t={cmd:101002,roleId:44444,sign:"a76c7d9b0bf418925fc5a5f5b2b559b5"}:4==this.player?t={cmd:101002,roleId:55555,sign:"cb473549f905a9a7c3e0e1a1f81c6203"}:5==this.player?t={cmd:101002,roleId:66666,sign:"a4970baba673ce6831e32f2664e10ce7"}:6==this.player?t={cmd:101002,roleId:77777,sign:"85c3c03cbbe8d7c7f64d22e56e10722a"}:7==this.player&&(t={cmd:101002,roleId:88888,sign:"8ba55c4a69adedadb9fa369f1efa1748"}),App.gameSocket.send(t)
},t.prototype.onSocketError=function(e){e==App.gameSocket&&console.log("网络连接失败，请检查您的网络。")},t.prototype.showLoginScene=function(){this.startLoadLogin()},t.prototype.startLoadLogin=function(){var e=(App.PanelManager.open(PanelConst.PreloadPanel),["hall","common","gamecom","dkgame",AssetConst.Res_13Dao]);App.ResUtils.loadGroup(e,this,this.loadLoginComplete,this.loadLoginProgress)},t.prototype.loadLoginProgress=function(e){var t=App.PanelManager.getPanel(PanelConst.PreloadPanel);t.setProgress(e.itemsLoaded/e.itemsTotal)},t.prototype.loadLoginComplete=function(){App.DataCenter.UserInfo.setMyUserVo(),App.PanelManager.close(PanelConst.PreloadPanel),App.SceneManager.runScene(SceneConst.DKGameScene)},t.prototype.gotoHall=function(){console.log("显示大厅"),App.getInstance().sendEvent(HallController.EVENT_SHOW_HALL)},t.NAME="LoginController",t.EVENT_SHOW_LOGIN="ShowLoginScene",t}(BaseController);__reflect(LoginController.prototype,"LoginController");var LoginScene=function(e){function t(){var t=e.call(this)||this;return t.isPlayed=!1,t.skinName="LoginSceneSkin",t}return __extends(t,e),t.prototype.onEnable=function(){this.btnXieYi.text="同意<<用户使用协议>>",this.cbBox.selected=!0,this.btnXieYi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xieyiTouched,this),this.cbBox.addEventListener(egret.Event.CHANGE,this.cbBoxChange,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.soundPlay,this),this.addEventListener(eui.UIEvent.CHANGE,this.change,this),App.DeviceUtils.IsNative&&(this.isToken(),this.backWXLogin())},t.prototype.soundPlay=function(){this.isPlayed||(App.SoundManager.playBGM("music_mp3"),this.isPlayed=!0)},t.prototype.xieyiTouched=function(e){this.addChild(new Xieyi)},t.prototype.onRemove=function(){this.wxLoginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onWXLogin,this)},t.prototype.isToken=function(){var e=egret.localStorage.getItem("refresh_token");if(null!=e&&void 0!=e){this.wxLoginBtn.visible=!1;new LoginController}else this.wxLoginBtn.visible=!0},t.prototype.backWXLogin=function(){var e=this;egret.ExternalInterface.addCallback("sendToJS",function(t){console.error("message form native: "+t);var n=JSON.parse(t);n.cmd;if("wxLogin"==n.cmd)0==n.code?App.HttpSender.sendByUrl("http://hjwl.vequn.org/appLogin?code="+n.data.code,e.wxLoginSuc,e):Tips.error("get code is error");else if("share"==n.cmd)if(0==n.code){if(App.DataCenter.sendMsg){App.DataCenter.sendMsg=!1;var o={cmd:110,game:0};App.gameSocket.send(o)}}else App.DataCenter.sendMsg=!1;else if("exit"==n.cmd){var r=App.MsgBoxManager.getBoxOC();r.showMsg("确定退出游戏？"),r.ok=function(){egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"exit"}))}}})},t.prototype.wxLoginSuc=function(e){console.error("wxLoginSuc"),App.DataCenter.UserInfo.setMyUserVo(e),this.ctrl.onLogin()},t.prototype.onWXLogin=function(e){egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=3,this.ctrl.onLogin()},t.prototype.onWXLogin0=function(e){egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=4,this.ctrl.onLogin()},t.prototype.onWXLogin1=function(e){egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=5,this.ctrl.onLogin()},t.prototype.onWXLogin2=function(e){egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=6,this.ctrl.onLogin()},t.prototype.onWXLogin3=function(e){egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=7,this.ctrl.onLogin()},t.prototype.onbtn0=function(e){var t=new LoginController;t.player=2,egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=0,this.ctrl.onLogin()},t.prototype.onbtn1=function(e){var t=new LoginController;t.player=2,egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=1,this.ctrl.onLogin()},t.prototype.onbtn2=function(e){var t=new LoginController;t.player=2,egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?egret.ExternalInterface.call("sendToNative",JSON.stringify({cmd:"wxLogin"})):this.ctrl.player=2,this.ctrl.onLogin()},t.prototype.getChangeList=function(){var e=RES.getVersionController().getChangeList(),t=e.length;console.log("加载列表长度:"+t);for(var n=0;t>n;n++)console.log("加载列表"+n+":"+e[n].url+","+e[n].size)},t.prototype.cbBoxChange=function(e){this.cbBox.getChildAt(1).visible=this.cbBox.selected,this.cbBox.selected?this.wxLoginBtn.touchEnabled=!0:this.wxLoginBtn.touchEnabled=!1},t.prototype.change=function(e){console.log("change")},t}(BaseScene);__reflect(LoginScene.prototype,"LoginScene");var Xieyi=function(e){function t(){var t=e.call(this)||this;return t.skinName="XieyiSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},t.prototype.close=function(e){this.parent&&this.parent.removeChild(this)},t}(BasePanel);__reflect(Xieyi.prototype,"Xieyi");